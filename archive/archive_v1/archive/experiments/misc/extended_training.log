======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.2, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Beta for epoch 0: 0.3000
/home/me/.local/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:236: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Epoch 0 [0/469] Loss: 2.7350 Acc: 0.1953 Iters: 50/50
Epoch 0 [100/469] Loss: 2.3125 Acc: 0.2266 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2341 Acc: 0.1484 Iters: 50/50
Epoch 0 [300/469] Loss: 2.1036 Acc: 0.3281 Iters: 50/50
Epoch 0 [400/469] Loss: 1.6809 Acc: 0.3906 Iters: 50/50
W1228 12:29:13.705000 566368 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1228 12:29:13.705000 566368 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1228 12:29:13.705000 566368 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1228 12:29:13.705000 566368 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1228 12:29:13.705000 566368 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.0516, Train Acc: 0.2854
  Test Loss: 1.3746, Test Acc: 0.4524
  Avg Iters: 50.0/50.0
  Time: 83.0s
Beta for epoch 1: 0.2929
Epoch 1 [0/469] Loss: 1.3292 Acc: 0.5234 Iters: 50/50
Epoch 1 [100/469] Loss: 1.2066 Acc: 0.5391 Iters: 50/50
Epoch 1 [200/469] Loss: 0.9774 Acc: 0.6016 Iters: 50/50
Epoch 1 [300/469] Loss: 0.9512 Acc: 0.6250 Iters: 50/50
Epoch 1 [400/469] Loss: 0.8407 Acc: 0.7109 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.0924, Train Acc: 0.6132
  Test Loss: 0.8478, Test Acc: 0.7220
  Avg Iters: 50.0/50.0
  Time: 65.7s
Beta for epoch 2: 0.2857
Epoch 2 [0/469] Loss: 0.8659 Acc: 0.7188 Iters: 50/50
Epoch 2 [100/469] Loss: 0.6632 Acc: 0.7969 Iters: 50/50
Epoch 2 [200/469] Loss: 0.6326 Acc: 0.7891 Iters: 50/50
Epoch 2 [300/469] Loss: 0.4659 Acc: 0.8281 Iters: 50/50
Epoch 2 [400/469] Loss: 0.6589 Acc: 0.8047 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.6473, Train Acc: 0.7997
  Test Loss: 0.5009, Test Acc: 0.8462
  Avg Iters: 50.0/50.0
  Time: 67.5s
Beta for epoch 3: 0.2786
Epoch 3 [0/469] Loss: 0.4419 Acc: 0.8672 Iters: 50/50
Epoch 3 [100/469] Loss: 0.5085 Acc: 0.8438 Iters: 50/50
Epoch 3 [200/469] Loss: 0.5710 Acc: 0.8047 Iters: 50/50
Epoch 3 [300/469] Loss: 0.4637 Acc: 0.8516 Iters: 50/50
Epoch 3 [400/469] Loss: 0.4321 Acc: 0.8828 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.4631, Train Acc: 0.8651
  Test Loss: 0.4158, Test Acc: 0.8763
  Avg Iters: 50.0/50.0
  Time: 65.7s
Beta for epoch 4: 0.2714
Epoch 4 [0/469] Loss: 0.3592 Acc: 0.8828 Iters: 50/50
Epoch 4 [100/469] Loss: 0.5069 Acc: 0.8672 Iters: 50/50
Epoch 4 [200/469] Loss: 0.2361 Acc: 0.9219 Iters: 50/50
Epoch 4 [300/469] Loss: 0.3625 Acc: 0.8906 Iters: 50/50
Epoch 4 [400/469] Loss: 0.3980 Acc: 0.9062 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4016, Train Acc: 0.8850
  Test Loss: 0.3619, Test Acc: 0.8960
  Avg Iters: 50.0/50.0
  Time: 65.2s
Beta for epoch 5: 0.2643
Epoch 5 [0/469] Loss: 0.4208 Acc: 0.8828 Iters: 50/50
Epoch 5 [100/469] Loss: 0.1841 Acc: 0.9609 Iters: 50/50
Epoch 5 [200/469] Loss: 0.3039 Acc: 0.9062 Iters: 50/50
Epoch 5 [300/469] Loss: 0.4286 Acc: 0.9062 Iters: 50/50
Epoch 5 [400/469] Loss: 0.3498 Acc: 0.9219 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3692, Train Acc: 0.8947
  Test Loss: 0.3548, Test Acc: 0.8968
  Avg Iters: 50.0/50.0
  Time: 65.9s
Beta for epoch 6: 0.2571
Epoch 6 [0/469] Loss: 0.2953 Acc: 0.9062 Iters: 50/50
Epoch 6 [100/469] Loss: 0.5426 Acc: 0.8281 Iters: 50/50
Epoch 6 [200/469] Loss: 0.2800 Acc: 0.9141 Iters: 50/50
Epoch 6 [300/469] Loss: 0.3414 Acc: 0.9219 Iters: 50/50
Epoch 6 [400/469] Loss: 0.3272 Acc: 0.9219 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3551, Train Acc: 0.8987
  Test Loss: 0.3426, Test Acc: 0.9014
  Avg Iters: 50.0/50.0
  Time: 67.3s
Beta for epoch 7: 0.2500
Epoch 7 [0/469] Loss: 0.4856 Acc: 0.8594 Iters: 50/50
Epoch 7 [100/469] Loss: 0.5245 Acc: 0.8750 Iters: 50/50
Epoch 7 [200/469] Loss: 0.4119 Acc: 0.8359 Iters: 50/50
Epoch 7 [300/469] Loss: 0.2465 Acc: 0.9375 Iters: 50/50
Epoch 7 [400/469] Loss: 0.3150 Acc: 0.8672 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3330, Train Acc: 0.9064
  Test Loss: 0.3086, Test Acc: 0.9122
  Avg Iters: 50.0/50.0
  Time: 67.2s
Beta for epoch 8: 0.2429
Epoch 8 [0/469] Loss: 0.3360 Acc: 0.9062 Iters: 50/50
Epoch 8 [100/469] Loss: 0.2452 Acc: 0.9375 Iters: 50/50
Epoch 8 [200/469] Loss: 0.3603 Acc: 0.8828 Iters: 50/50
Epoch 8 [300/469] Loss: 0.3569 Acc: 0.9141 Iters: 50/50
Epoch 8 [400/469] Loss: 0.2641 Acc: 0.9141 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3156, Train Acc: 0.9099
  Test Loss: 0.2939, Test Acc: 0.9156
  Avg Iters: 50.0/50.0
  Time: 68.1s
Beta for epoch 9: 0.2357
Epoch 9 [0/469] Loss: 0.2712 Acc: 0.9219 Iters: 50/50
Epoch 9 [100/469] Loss: 0.2835 Acc: 0.8984 Iters: 50/50
Epoch 9 [200/469] Loss: 0.3294 Acc: 0.9375 Iters: 50/50
Epoch 9 [300/469] Loss: 0.5435 Acc: 0.8906 Iters: 50/50
Epoch 9 [400/469] Loss: 0.1805 Acc: 0.9453 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3068, Train Acc: 0.9126
  Test Loss: 0.3123, Test Acc: 0.9094
  Avg Iters: 50.0/50.0
  Time: 88.8s
Beta for epoch 10: 0.2286
Epoch 10 [0/469] Loss: 0.2696 Acc: 0.8906 Iters: 50/50
Epoch 10 [100/469] Loss: 0.4773 Acc: 0.9062 Iters: 50/50
Epoch 10 [200/469] Loss: 0.3873 Acc: 0.9141 Iters: 50/50
Epoch 10 [300/469] Loss: 0.3179 Acc: 0.9062 Iters: 50/50
Epoch 10 [400/469] Loss: 0.3962 Acc: 0.8906 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.3151, Train Acc: 0.9127
  Test Loss: 0.2895, Test Acc: 0.9182
  Avg Iters: 50.0/50.0
  Time: 117.6s
Beta for epoch 11: 0.2214
Epoch 11 [0/469] Loss: 0.2849 Acc: 0.8984 Iters: 50/50
Epoch 11 [100/469] Loss: 0.3811 Acc: 0.9062 Iters: 50/50
Epoch 11 [200/469] Loss: 0.1520 Acc: 0.9453 Iters: 50/50
Epoch 11 [300/469] Loss: 0.2883 Acc: 0.9141 Iters: 50/50
Epoch 11 [400/469] Loss: 0.3298 Acc: 0.9375 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.2866, Train Acc: 0.9186
  Test Loss: 0.2910, Test Acc: 0.9169
  Avg Iters: 50.0/50.0
  Time: 79.4s
Beta for epoch 12: 0.2143
Epoch 12 [0/469] Loss: 0.2496 Acc: 0.9375 Iters: 50/50
Epoch 12 [100/469] Loss: 0.3843 Acc: 0.9453 Iters: 50/50
Epoch 12 [200/469] Loss: 0.1351 Acc: 0.9453 Iters: 50/50
Epoch 12 [300/469] Loss: 0.4599 Acc: 0.8672 Iters: 50/50
Epoch 12 [400/469] Loss: 0.4055 Acc: 0.8984 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.2905, Train Acc: 0.9164
  Test Loss: 0.2943, Test Acc: 0.9152
  Avg Iters: 50.0/50.0
  Time: 63.6s
Beta for epoch 13: 0.2071
Epoch 13 [0/469] Loss: 0.2945 Acc: 0.9219 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2735 Acc: 0.9219 Iters: 50/50
Epoch 13 [200/469] Loss: 0.4247 Acc: 0.8828 Iters: 50/50
Epoch 13 [300/469] Loss: 0.2127 Acc: 0.9297 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2588 Acc: 0.9141 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.2782, Train Acc: 0.9199
  Test Loss: 0.2746, Test Acc: 0.9211
  Avg Iters: 50.0/50.0
  Time: 63.5s
Beta for epoch 14: 0.2000
Epoch 14 [0/469] Loss: 0.0847 Acc: 0.9844 Iters: 50/50
Epoch 14 [100/469] Loss: 2.0893 Acc: 0.2109 Iters: 50/50
Epoch 14 [200/469] Loss: 1.9271 Acc: 0.3906 Iters: 50/50
Epoch 14 [300/469] Loss: 1.5562 Acc: 0.6172 Iters: 50/50
Epoch 14 [400/469] Loss: 1.1389 Acc: 0.7500 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 1.4986, Train Acc: 0.5666
  Test Loss: 0.9145, Test Acc: 0.7525
  Avg Iters: 50.0/50.0
  Time: 63.1s

======================================================================
Training complete! Best test accuracy: 0.9211
======================================================================
