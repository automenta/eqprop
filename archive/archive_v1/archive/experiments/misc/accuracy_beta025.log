======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.25, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 2.7321 Acc: 0.1797 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2796 Acc: 0.1250 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2827 Acc: 0.0859 Iters: 50/50
Epoch 0 [300/469] Loss: 2.1864 Acc: 0.1953 Iters: 50/50
Epoch 0 [400/469] Loss: 2.0493 Acc: 0.3359 Iters: 50/50
W1228 15:24:35.184000 649229 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1228 15:24:35.184000 649229 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1228 15:24:35.184000 649229 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1228 15:24:35.184000 649229 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1228 15:24:35.184000 649229 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.2121, Train Acc: 0.2047
  Test Loss: 1.8280, Test Acc: 0.3782
  Avg Iters: 50.0/50.0
  Time: 67.9s
Epoch 1 [0/469] Loss: 1.8010 Acc: 0.3906 Iters: 50/50
Epoch 1 [100/469] Loss: 1.4953 Acc: 0.5000 Iters: 50/50
Epoch 1 [200/469] Loss: 1.1962 Acc: 0.5234 Iters: 50/50
Epoch 1 [300/469] Loss: 1.1156 Acc: 0.6172 Iters: 50/50
Epoch 1 [400/469] Loss: 0.9153 Acc: 0.7578 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.2233, Train Acc: 0.5702
  Test Loss: 0.9189, Test Acc: 0.7087
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 2 [0/469] Loss: 0.8353 Acc: 0.7891 Iters: 50/50
Epoch 2 [100/469] Loss: 0.6822 Acc: 0.7891 Iters: 50/50
Epoch 2 [200/469] Loss: 0.6053 Acc: 0.7734 Iters: 50/50
Epoch 2 [300/469] Loss: 0.7319 Acc: 0.7578 Iters: 50/50
Epoch 2 [400/469] Loss: 0.7294 Acc: 0.7656 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.6962, Train Acc: 0.7916
  Test Loss: 0.5203, Test Acc: 0.8508
  Avg Iters: 50.0/50.0
  Time: 65.5s
Epoch 3 [0/469] Loss: 0.5894 Acc: 0.8281 Iters: 50/50
Epoch 3 [100/469] Loss: 0.4573 Acc: 0.8438 Iters: 50/50
Epoch 3 [200/469] Loss: 0.3769 Acc: 0.8828 Iters: 50/50
Epoch 3 [300/469] Loss: 0.6938 Acc: 0.8125 Iters: 50/50
Epoch 3 [400/469] Loss: 0.5458 Acc: 0.8672 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.4806, Train Acc: 0.8592
  Test Loss: 0.4260, Test Acc: 0.8757
  Avg Iters: 50.0/50.0
  Time: 65.3s
Epoch 4 [0/469] Loss: 0.4954 Acc: 0.8984 Iters: 50/50
Epoch 4 [100/469] Loss: 0.4730 Acc: 0.8281 Iters: 50/50
Epoch 4 [200/469] Loss: 0.2792 Acc: 0.8984 Iters: 50/50
Epoch 4 [300/469] Loss: 0.3490 Acc: 0.8750 Iters: 50/50
Epoch 4 [400/469] Loss: 0.4676 Acc: 0.8281 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4031, Train Acc: 0.8832
  Test Loss: 0.3915, Test Acc: 0.8859
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 5 [0/469] Loss: 0.2579 Acc: 0.8906 Iters: 50/50
Epoch 5 [100/469] Loss: 0.3707 Acc: 0.8828 Iters: 50/50
Epoch 5 [200/469] Loss: 0.3283 Acc: 0.9297 Iters: 50/50
Epoch 5 [300/469] Loss: 0.3290 Acc: 0.9141 Iters: 50/50
Epoch 5 [400/469] Loss: 0.2145 Acc: 0.9219 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3692, Train Acc: 0.8935
  Test Loss: 0.3426, Test Acc: 0.9008
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 6 [0/469] Loss: 0.3387 Acc: 0.9219 Iters: 50/50
Epoch 6 [100/469] Loss: 0.3154 Acc: 0.9219 Iters: 50/50
Epoch 6 [200/469] Loss: 0.3640 Acc: 0.8984 Iters: 50/50
Epoch 6 [300/469] Loss: 0.2934 Acc: 0.9062 Iters: 50/50
Epoch 6 [400/469] Loss: 0.2676 Acc: 0.9297 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3559, Train Acc: 0.8990
  Test Loss: 0.3248, Test Acc: 0.9071
  Avg Iters: 50.0/50.0
  Time: 66.4s
Epoch 7 [0/469] Loss: 0.2385 Acc: 0.9062 Iters: 50/50
Epoch 7 [100/469] Loss: 0.3738 Acc: 0.8672 Iters: 50/50
Epoch 7 [200/469] Loss: 0.2752 Acc: 0.9219 Iters: 50/50
Epoch 7 [300/469] Loss: 0.3920 Acc: 0.8828 Iters: 50/50
Epoch 7 [400/469] Loss: 0.3977 Acc: 0.8906 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3267, Train Acc: 0.9059
  Test Loss: 0.3057, Test Acc: 0.9125
  Avg Iters: 50.0/50.0
  Time: 66.2s
Epoch 8 [0/469] Loss: 0.2269 Acc: 0.9297 Iters: 50/50
Epoch 8 [100/469] Loss: 0.4133 Acc: 0.8906 Iters: 50/50
Epoch 8 [200/469] Loss: 0.3014 Acc: 0.9297 Iters: 50/50
Epoch 8 [300/469] Loss: 0.2590 Acc: 0.9531 Iters: 50/50
Epoch 8 [400/469] Loss: 0.3138 Acc: 0.8984 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3165, Train Acc: 0.9091
  Test Loss: 0.3146, Test Acc: 0.9087
  Avg Iters: 50.0/50.0
  Time: 64.9s
Epoch 9 [0/469] Loss: 0.4004 Acc: 0.8984 Iters: 50/50
Epoch 9 [100/469] Loss: 0.3392 Acc: 0.8828 Iters: 50/50
Epoch 9 [200/469] Loss: 0.3969 Acc: 0.9141 Iters: 50/50
Epoch 9 [300/469] Loss: 0.4313 Acc: 0.9141 Iters: 50/50
Epoch 9 [400/469] Loss: 0.3080 Acc: 0.9062 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3134, Train Acc: 0.9095
  Test Loss: 0.2993, Test Acc: 0.9150
  Avg Iters: 50.0/50.0
  Time: 65.6s
Epoch 10 [0/469] Loss: 0.4164 Acc: 0.8516 Iters: 50/50
Epoch 10 [100/469] Loss: 0.1547 Acc: 0.9766 Iters: 50/50
Epoch 10 [200/469] Loss: 0.1608 Acc: 0.9375 Iters: 50/50
Epoch 10 [300/469] Loss: 0.3115 Acc: 0.9219 Iters: 50/50
Epoch 10 [400/469] Loss: 0.2905 Acc: 0.9062 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.2959, Train Acc: 0.9151
  Test Loss: 0.3024, Test Acc: 0.9107
  Avg Iters: 50.0/50.0
  Time: 65.0s
Epoch 11 [0/469] Loss: 0.3822 Acc: 0.8984 Iters: 50/50
Epoch 11 [100/469] Loss: 0.3590 Acc: 0.8750 Iters: 50/50
Epoch 11 [200/469] Loss: 0.3705 Acc: 0.9062 Iters: 50/50
Epoch 11 [300/469] Loss: 0.1691 Acc: 0.9219 Iters: 50/50
Epoch 11 [400/469] Loss: 0.3378 Acc: 0.9062 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.2845, Train Acc: 0.9176
  Test Loss: 0.2993, Test Acc: 0.9166
  Avg Iters: 50.0/50.0
  Time: 66.0s
Epoch 12 [0/469] Loss: 0.3024 Acc: 0.9297 Iters: 50/50
Epoch 12 [100/469] Loss: 0.3487 Acc: 0.9141 Iters: 50/50
Epoch 12 [200/469] Loss: 0.3047 Acc: 0.9062 Iters: 50/50
Epoch 12 [300/469] Loss: 0.3208 Acc: 0.9062 Iters: 50/50
Epoch 12 [400/469] Loss: 0.1965 Acc: 0.9297 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.3126, Train Acc: 0.9102
  Test Loss: 0.3059, Test Acc: 0.9105
  Avg Iters: 50.0/50.0
  Time: 65.8s
Epoch 13 [0/469] Loss: 0.1943 Acc: 0.9453 Iters: 50/50
Epoch 13 [100/469] Loss: 0.3885 Acc: 0.8594 Iters: 50/50
Epoch 13 [200/469] Loss: 0.1995 Acc: 0.9453 Iters: 50/50
Epoch 13 [300/469] Loss: 0.1788 Acc: 0.9609 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2561 Acc: 0.9219 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.2801, Train Acc: 0.9199
  Test Loss: 0.3010, Test Acc: 0.9149
  Avg Iters: 50.0/50.0
  Time: 66.0s
Epoch 14 [0/469] Loss: 0.3457 Acc: 0.8672 Iters: 50/50
Epoch 14 [100/469] Loss: 0.2822 Acc: 0.9141 Iters: 50/50
Epoch 14 [200/469] Loss: 0.2319 Acc: 0.9219 Iters: 50/50
Epoch 14 [300/469] Loss: 0.4243 Acc: 0.8672 Iters: 50/50
Epoch 14 [400/469] Loss: 0.1533 Acc: 0.9531 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.2691, Train Acc: 0.9220
  Test Loss: 0.2699, Test Acc: 0.9209
  Avg Iters: 50.0/50.0
  Time: 66.2s

======================================================================
Training complete! Best test accuracy: 0.9209
======================================================================
