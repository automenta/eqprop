======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.22, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 3.6022 Acc: 0.0938 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2689 Acc: 0.2500 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2660 Acc: 0.0859 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2474 Acc: 0.2109 Iters: 50/50
Epoch 0 [400/469] Loss: 2.1986 Acc: 0.2891 Iters: 50/50
W1229 07:15:02.556000 720647 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1229 07:15:02.556000 720647 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1229 07:15:02.556000 720647 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1229 07:15:02.556000 720647 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1229 07:15:02.556000 720647 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.2360, Train Acc: 0.2040
  Test Loss: 2.0198, Test Acc: 0.2814
  Avg Iters: 50.0/50.0
  Time: 66.7s
Epoch 1 [0/469] Loss: 2.0343 Acc: 0.2578 Iters: 50/50
Epoch 1 [100/469] Loss: 1.6474 Acc: 0.5078 Iters: 50/50
Epoch 1 [200/469] Loss: 1.4489 Acc: 0.4531 Iters: 50/50
Epoch 1 [300/469] Loss: 1.2677 Acc: 0.5312 Iters: 50/50
Epoch 1 [400/469] Loss: 1.0129 Acc: 0.6172 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.3794, Train Acc: 0.5339
  Test Loss: 0.9526, Test Acc: 0.6817
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 2 [0/469] Loss: 1.0233 Acc: 0.7031 Iters: 50/50
Epoch 2 [100/469] Loss: 0.8191 Acc: 0.7266 Iters: 50/50
Epoch 2 [200/469] Loss: 0.6129 Acc: 0.8047 Iters: 50/50
Epoch 2 [300/469] Loss: 0.6843 Acc: 0.7656 Iters: 50/50
Epoch 2 [400/469] Loss: 0.6374 Acc: 0.8125 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.7329, Train Acc: 0.7692
  Test Loss: 0.5843, Test Acc: 0.8300
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 3 [0/469] Loss: 0.7011 Acc: 0.7422 Iters: 50/50
Epoch 3 [100/469] Loss: 0.4730 Acc: 0.8672 Iters: 50/50
Epoch 3 [200/469] Loss: 0.3545 Acc: 0.9297 Iters: 50/50
Epoch 3 [300/469] Loss: 0.3448 Acc: 0.9219 Iters: 50/50
Epoch 3 [400/469] Loss: 0.3367 Acc: 0.8828 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.5088, Train Acc: 0.8517
  Test Loss: 0.4298, Test Acc: 0.8769
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 4 [0/469] Loss: 0.4516 Acc: 0.8672 Iters: 50/50
Epoch 4 [100/469] Loss: 0.3910 Acc: 0.8750 Iters: 50/50
Epoch 4 [200/469] Loss: 0.3919 Acc: 0.9062 Iters: 50/50
Epoch 4 [300/469] Loss: 0.4577 Acc: 0.8672 Iters: 50/50
Epoch 4 [400/469] Loss: 0.4453 Acc: 0.9062 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4110, Train Acc: 0.8825
  Test Loss: 0.3773, Test Acc: 0.8927
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 5 [0/469] Loss: 0.3981 Acc: 0.8984 Iters: 50/50
Epoch 5 [100/469] Loss: 0.3685 Acc: 0.8672 Iters: 50/50
Epoch 5 [200/469] Loss: 0.4538 Acc: 0.8828 Iters: 50/50
Epoch 5 [300/469] Loss: 0.4983 Acc: 0.8672 Iters: 50/50
Epoch 5 [400/469] Loss: 0.2639 Acc: 0.9375 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3787, Train Acc: 0.8908
  Test Loss: 0.3743, Test Acc: 0.8934
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 6 [0/469] Loss: 0.3204 Acc: 0.8984 Iters: 50/50
Epoch 6 [100/469] Loss: 0.4724 Acc: 0.8828 Iters: 50/50
Epoch 6 [200/469] Loss: 0.3338 Acc: 0.8672 Iters: 50/50
Epoch 6 [300/469] Loss: 0.3088 Acc: 0.9375 Iters: 50/50
Epoch 6 [400/469] Loss: 0.4889 Acc: 0.8672 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3601, Train Acc: 0.8973
  Test Loss: 0.3465, Test Acc: 0.8997
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 7 [0/469] Loss: 0.3371 Acc: 0.9375 Iters: 50/50
Epoch 7 [100/469] Loss: 0.2555 Acc: 0.9219 Iters: 50/50
Epoch 7 [200/469] Loss: 0.4606 Acc: 0.8750 Iters: 50/50
Epoch 7 [300/469] Loss: 0.3687 Acc: 0.9062 Iters: 50/50
Epoch 7 [400/469] Loss: 0.2320 Acc: 0.9297 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3353, Train Acc: 0.9051
  Test Loss: 0.3133, Test Acc: 0.9117
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 8 [0/469] Loss: 0.2180 Acc: 0.9531 Iters: 50/50
Epoch 8 [100/469] Loss: 0.2752 Acc: 0.9141 Iters: 50/50
Epoch 8 [200/469] Loss: 0.2890 Acc: 0.9297 Iters: 50/50
Epoch 8 [300/469] Loss: 0.2371 Acc: 0.9375 Iters: 50/50
Epoch 8 [400/469] Loss: 0.3285 Acc: 0.9219 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3184, Train Acc: 0.9086
  Test Loss: 0.3180, Test Acc: 0.9097
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 9 [0/469] Loss: 0.6698 Acc: 0.8906 Iters: 50/50
Epoch 9 [100/469] Loss: 0.3483 Acc: 0.8828 Iters: 50/50
Epoch 9 [200/469] Loss: 0.3239 Acc: 0.8906 Iters: 50/50
Epoch 9 [300/469] Loss: 0.2784 Acc: 0.9297 Iters: 50/50
Epoch 9 [400/469] Loss: 0.1690 Acc: 0.9375 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3018, Train Acc: 0.9139
  Test Loss: 0.2913, Test Acc: 0.9166
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 10 [0/469] Loss: 0.2860 Acc: 0.9141 Iters: 50/50
Epoch 10 [100/469] Loss: 0.2373 Acc: 0.9297 Iters: 50/50
Epoch 10 [200/469] Loss: 0.1434 Acc: 0.9453 Iters: 50/50
Epoch 10 [300/469] Loss: 0.2636 Acc: 0.8984 Iters: 50/50
Epoch 10 [400/469] Loss: 0.3241 Acc: 0.8984 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.3034, Train Acc: 0.9136
  Test Loss: 0.3191, Test Acc: 0.9069
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 11 [0/469] Loss: 0.2971 Acc: 0.9141 Iters: 50/50
Epoch 11 [100/469] Loss: 0.2895 Acc: 0.9141 Iters: 50/50
Epoch 11 [200/469] Loss: 0.3189 Acc: 0.8672 Iters: 50/50
Epoch 11 [300/469] Loss: 0.2409 Acc: 0.9453 Iters: 50/50
Epoch 11 [400/469] Loss: 0.2379 Acc: 0.9531 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.3008, Train Acc: 0.9149
  Test Loss: 0.3124, Test Acc: 0.9107
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 12 [0/469] Loss: 0.3136 Acc: 0.9297 Iters: 50/50
Epoch 12 [100/469] Loss: 0.1417 Acc: 0.9531 Iters: 50/50
Epoch 12 [200/469] Loss: 0.2594 Acc: 0.9141 Iters: 50/50
Epoch 12 [300/469] Loss: 0.2570 Acc: 0.9062 Iters: 50/50
Epoch 12 [400/469] Loss: 0.3091 Acc: 0.8984 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.2966, Train Acc: 0.9142
  Test Loss: 0.3083, Test Acc: 0.9085
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 13 [0/469] Loss: 0.3010 Acc: 0.9141 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2544 Acc: 0.9219 Iters: 50/50
Epoch 13 [200/469] Loss: 0.2597 Acc: 0.9453 Iters: 50/50
Epoch 13 [300/469] Loss: 0.3793 Acc: 0.9141 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2742 Acc: 0.8906 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.2866, Train Acc: 0.9177
  Test Loss: 0.2842, Test Acc: 0.9164
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 14 [0/469] Loss: 0.3565 Acc: 0.8984 Iters: 50/50
Epoch 14 [100/469] Loss: 0.1423 Acc: 0.9531 Iters: 50/50
Epoch 14 [200/469] Loss: 0.2013 Acc: 0.9453 Iters: 50/50
Epoch 14 [300/469] Loss: 0.3072 Acc: 0.9219 Iters: 50/50
Epoch 14 [400/469] Loss: 0.3978 Acc: 0.8984 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.2732, Train Acc: 0.9208
  Test Loss: 0.2792, Test Acc: 0.9230
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 15 [0/469] Loss: 0.2850 Acc: 0.9375 Iters: 50/50
Epoch 15 [100/469] Loss: 0.3153 Acc: 0.9375 Iters: 50/50
Epoch 15 [200/469] Loss: 0.3265 Acc: 0.9062 Iters: 50/50
Epoch 15 [300/469] Loss: 0.3529 Acc: 0.9219 Iters: 50/50
Epoch 15 [400/469] Loss: 0.2577 Acc: 0.8984 Iters: 50/50

Epoch 15 Summary:
  Train Loss: 0.2765, Train Acc: 0.9202
  Test Loss: 0.2713, Test Acc: 0.9208
  Avg Iters: 50.0/50.0
  Time: 65.1s
Epoch 16 [0/469] Loss: 0.3341 Acc: 0.8594 Iters: 50/50
Epoch 16 [100/469] Loss: 0.2687 Acc: 0.9062 Iters: 50/50
Epoch 16 [200/469] Loss: 0.2056 Acc: 0.9141 Iters: 50/50
Epoch 16 [300/469] Loss: 0.1388 Acc: 0.9531 Iters: 50/50
Epoch 16 [400/469] Loss: 0.3252 Acc: 0.9297 Iters: 50/50

Epoch 16 Summary:
  Train Loss: 0.2669, Train Acc: 0.9232
  Test Loss: 0.2876, Test Acc: 0.9137
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 17 [0/469] Loss: 0.2802 Acc: 0.9062 Iters: 50/50
Epoch 17 [100/469] Loss: 0.1976 Acc: 0.9375 Iters: 50/50
Epoch 17 [200/469] Loss: 0.2000 Acc: 0.9297 Iters: 50/50
Epoch 17 [300/469] Loss: 0.2559 Acc: 0.9297 Iters: 50/50
Epoch 17 [400/469] Loss: 0.2707 Acc: 0.9297 Iters: 50/50

Epoch 17 Summary:
  Train Loss: 0.2755, Train Acc: 0.9209
  Test Loss: 0.2921, Test Acc: 0.9184
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 18 [0/469] Loss: 0.4038 Acc: 0.9141 Iters: 50/50
Epoch 18 [100/469] Loss: 0.2741 Acc: 0.9219 Iters: 50/50
Epoch 18 [200/469] Loss: 0.2746 Acc: 0.9062 Iters: 50/50
Epoch 18 [300/469] Loss: 0.1381 Acc: 0.9609 Iters: 50/50
Epoch 18 [400/469] Loss: 0.2072 Acc: 0.9219 Iters: 50/50

Epoch 18 Summary:
  Train Loss: 0.2634, Train Acc: 0.9239
  Test Loss: 0.2676, Test Acc: 0.9223
  Avg Iters: 50.0/50.0
  Time: 64.8s
Epoch 19 [0/469] Loss: 0.2065 Acc: 0.9219 Iters: 50/50
Epoch 19 [100/469] Loss: 0.2858 Acc: 0.9219 Iters: 50/50
Epoch 19 [200/469] Loss: 0.3646 Acc: 0.8750 Iters: 50/50
Epoch 19 [300/469] Loss: 0.2063 Acc: 0.9375 Iters: 50/50
Epoch 19 [400/469] Loss: 0.3428 Acc: 0.9062 Iters: 50/50

Epoch 19 Summary:
  Train Loss: 0.2564, Train Acc: 0.9256
  Test Loss: 0.2700, Test Acc: 0.9218
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 20 [0/469] Loss: 0.1449 Acc: 0.9688 Iters: 50/50
Epoch 20 [100/469] Loss: 0.3205 Acc: 0.8984 Iters: 50/50
Epoch 20 [200/469] Loss: 0.2481 Acc: 0.9375 Iters: 50/50
Epoch 20 [300/469] Loss: 0.1865 Acc: 0.9375 Iters: 50/50
Epoch 20 [400/469] Loss: 0.1744 Acc: 0.9375 Iters: 50/50

Epoch 20 Summary:
  Train Loss: 0.2562, Train Acc: 0.9256
  Test Loss: 0.2815, Test Acc: 0.9151
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 21 [0/469] Loss: 0.2158 Acc: 0.9453 Iters: 50/50
Epoch 21 [100/469] Loss: 0.4546 Acc: 0.9062 Iters: 50/50
Epoch 21 [200/469] Loss: 0.2196 Acc: 0.9062 Iters: 50/50
Epoch 21 [300/469] Loss: 0.2019 Acc: 0.9531 Iters: 50/50
Epoch 21 [400/469] Loss: 0.3993 Acc: 0.8672 Iters: 50/50

Epoch 21 Summary:
  Train Loss: 0.2538, Train Acc: 0.9252
  Test Loss: 0.2573, Test Acc: 0.9229
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 22 [0/469] Loss: 0.2190 Acc: 0.9219 Iters: 50/50
Epoch 22 [100/469] Loss: 0.4311 Acc: 0.8672 Iters: 50/50
Epoch 22 [200/469] Loss: 0.2407 Acc: 0.9062 Iters: 50/50
Epoch 22 [300/469] Loss: 0.6260 Acc: 0.8984 Iters: 50/50
Epoch 22 [400/469] Loss: 0.4822 Acc: 0.8359 Iters: 50/50

Epoch 22 Summary:
  Train Loss: 0.3381, Train Acc: 0.9059
  Test Loss: 0.3427, Test Acc: 0.9103
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 23 [0/469] Loss: 0.3387 Acc: 0.8906 Iters: 50/50
Epoch 23 [100/469] Loss: 0.3128 Acc: 0.9141 Iters: 50/50
Epoch 23 [200/469] Loss: 0.2811 Acc: 0.9141 Iters: 50/50
Epoch 23 [300/469] Loss: 0.2143 Acc: 0.9375 Iters: 50/50
Epoch 23 [400/469] Loss: 0.2786 Acc: 0.9219 Iters: 50/50

Epoch 23 Summary:
  Train Loss: 0.3011, Train Acc: 0.9178
  Test Loss: 0.2989, Test Acc: 0.9172
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 24 [0/469] Loss: 0.2053 Acc: 0.9375 Iters: 50/50
Epoch 24 [100/469] Loss: 0.2254 Acc: 0.9375 Iters: 50/50
Epoch 24 [200/469] Loss: 0.2518 Acc: 0.9141 Iters: 50/50
Epoch 24 [300/469] Loss: 0.2115 Acc: 0.9297 Iters: 50/50
Epoch 24 [400/469] Loss: 0.2759 Acc: 0.9531 Iters: 50/50

Epoch 24 Summary:
  Train Loss: 0.2695, Train Acc: 0.9243
  Test Loss: 0.2678, Test Acc: 0.9254
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 25 [0/469] Loss: 0.1832 Acc: 0.9531 Iters: 50/50
Epoch 25 [100/469] Loss: 0.2686 Acc: 0.9375 Iters: 50/50
Epoch 25 [200/469] Loss: 0.1292 Acc: 0.9609 Iters: 50/50
Epoch 25 [300/469] Loss: 0.2311 Acc: 0.9375 Iters: 50/50
Epoch 25 [400/469] Loss: 0.1169 Acc: 0.9766 Iters: 50/50

Epoch 25 Summary:
  Train Loss: 0.2583, Train Acc: 0.9263
  Test Loss: 0.2876, Test Acc: 0.9140
  Avg Iters: 50.0/50.0
  Time: 65.2s
Epoch 26 [0/469] Loss: 0.2750 Acc: 0.9219 Iters: 50/50
Epoch 26 [100/469] Loss: 0.3879 Acc: 0.8828 Iters: 50/50
Epoch 26 [200/469] Loss: 0.2575 Acc: 0.9141 Iters: 50/50
Epoch 26 [300/469] Loss: 0.1654 Acc: 0.9375 Iters: 50/50
Epoch 26 [400/469] Loss: 0.2406 Acc: 0.9297 Iters: 50/50

Epoch 26 Summary:
  Train Loss: 0.2547, Train Acc: 0.9268
  Test Loss: 0.2581, Test Acc: 0.9258
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 27 [0/469] Loss: 0.1506 Acc: 0.9531 Iters: 50/50
Epoch 27 [100/469] Loss: 0.3248 Acc: 0.9297 Iters: 50/50
Epoch 27 [200/469] Loss: 0.2981 Acc: 0.9062 Iters: 50/50
Epoch 27 [300/469] Loss: 0.3075 Acc: 0.8984 Iters: 50/50
Epoch 27 [400/469] Loss: 0.6097 Acc: 0.9062 Iters: 50/50

Epoch 27 Summary:
  Train Loss: 0.3946, Train Acc: 0.8984
  Test Loss: 0.3343, Test Acc: 0.9152
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 28 [0/469] Loss: 0.3772 Acc: 0.9375 Iters: 50/50
Epoch 28 [100/469] Loss: 0.2375 Acc: 0.9453 Iters: 50/50
Epoch 28 [200/469] Loss: 0.2936 Acc: 0.9219 Iters: 50/50
Epoch 28 [300/469] Loss: 0.2533 Acc: 0.9297 Iters: 50/50
Epoch 28 [400/469] Loss: 0.2589 Acc: 0.9453 Iters: 50/50

Epoch 28 Summary:
  Train Loss: 0.3177, Train Acc: 0.9183
  Test Loss: 0.3060, Test Acc: 0.9206
  Avg Iters: 50.0/50.0
  Time: 65.3s
Epoch 29 [0/469] Loss: 0.1723 Acc: 0.9453 Iters: 50/50
Epoch 29 [100/469] Loss: 0.2489 Acc: 0.9531 Iters: 50/50
Epoch 29 [200/469] Loss: 0.2521 Acc: 0.9453 Iters: 50/50
Epoch 29 [300/469] Loss: 0.2159 Acc: 0.9453 Iters: 50/50
Epoch 29 [400/469] Loss: 0.2062 Acc: 0.9531 Iters: 50/50

Epoch 29 Summary:
  Train Loss: 0.2841, Train Acc: 0.9240
  Test Loss: 0.2878, Test Acc: 0.9236
  Avg Iters: 50.0/50.0
  Time: 64.3s

======================================================================
Training complete! Best test accuracy: 0.9258
======================================================================
