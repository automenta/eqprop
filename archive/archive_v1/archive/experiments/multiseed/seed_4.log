======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.22, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 2.9182 Acc: 0.0859 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2973 Acc: 0.1094 Iters: 50/50
Epoch 0 [200/469] Loss: 2.3126 Acc: 0.1172 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2597 Acc: 0.1797 Iters: 50/50
Epoch 0 [400/469] Loss: 2.2215 Acc: 0.2422 Iters: 50/50
W1229 06:41:43.486000 711841 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1229 06:41:43.486000 711841 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1229 06:41:43.486000 711841 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1229 06:41:43.486000 711841 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1229 06:41:43.486000 711841 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.2888, Train Acc: 0.1567
  Test Loss: 2.2049, Test Acc: 0.2865
  Avg Iters: 50.0/50.0
  Time: 66.6s
Epoch 1 [0/469] Loss: 2.2646 Acc: 0.2031 Iters: 50/50
Epoch 1 [100/469] Loss: 1.9979 Acc: 0.3750 Iters: 50/50
Epoch 1 [200/469] Loss: 1.8147 Acc: 0.3828 Iters: 50/50
Epoch 1 [300/469] Loss: 1.6228 Acc: 0.3984 Iters: 50/50
Epoch 1 [400/469] Loss: 1.4831 Acc: 0.5312 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.7880, Train Acc: 0.3793
  Test Loss: 1.2291, Test Acc: 0.5584
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 2 [0/469] Loss: 1.2784 Acc: 0.5859 Iters: 50/50
Epoch 2 [100/469] Loss: 1.0460 Acc: 0.6641 Iters: 50/50
Epoch 2 [200/469] Loss: 0.9575 Acc: 0.6328 Iters: 50/50
Epoch 2 [300/469] Loss: 0.8032 Acc: 0.7500 Iters: 50/50
Epoch 2 [400/469] Loss: 0.7851 Acc: 0.7734 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.9174, Train Acc: 0.6870
  Test Loss: 0.6871, Test Acc: 0.7891
  Avg Iters: 50.0/50.0
  Time: 64.8s
Epoch 3 [0/469] Loss: 0.7056 Acc: 0.8203 Iters: 50/50
Epoch 3 [100/469] Loss: 0.7101 Acc: 0.7969 Iters: 50/50
Epoch 3 [200/469] Loss: 0.5355 Acc: 0.8281 Iters: 50/50
Epoch 3 [300/469] Loss: 0.5942 Acc: 0.8125 Iters: 50/50
Epoch 3 [400/469] Loss: 0.4526 Acc: 0.8516 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.6296, Train Acc: 0.8092
  Test Loss: 0.5583, Test Acc: 0.8346
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 4 [0/469] Loss: 0.4441 Acc: 0.8984 Iters: 50/50
Epoch 4 [100/469] Loss: 0.5698 Acc: 0.8281 Iters: 50/50
Epoch 4 [200/469] Loss: 0.5331 Acc: 0.8281 Iters: 50/50
Epoch 4 [300/469] Loss: 0.4451 Acc: 0.8828 Iters: 50/50
Epoch 4 [400/469] Loss: 0.4896 Acc: 0.8594 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.5096, Train Acc: 0.8517
  Test Loss: 0.4855, Test Acc: 0.8581
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 5 [0/469] Loss: 0.7289 Acc: 0.7891 Iters: 50/50
Epoch 5 [100/469] Loss: 0.4675 Acc: 0.8672 Iters: 50/50
Epoch 5 [200/469] Loss: 0.5393 Acc: 0.8672 Iters: 50/50
Epoch 5 [300/469] Loss: 0.5260 Acc: 0.8672 Iters: 50/50
Epoch 5 [400/469] Loss: 0.3369 Acc: 0.8984 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.4424, Train Acc: 0.8732
  Test Loss: 0.4197, Test Acc: 0.8767
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 6 [0/469] Loss: 0.4125 Acc: 0.8750 Iters: 50/50
Epoch 6 [100/469] Loss: 0.4813 Acc: 0.8359 Iters: 50/50
Epoch 6 [200/469] Loss: 0.3781 Acc: 0.8750 Iters: 50/50
Epoch 6 [300/469] Loss: 0.2931 Acc: 0.9141 Iters: 50/50
Epoch 6 [400/469] Loss: 0.3050 Acc: 0.9062 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3968, Train Acc: 0.8854
  Test Loss: 0.3713, Test Acc: 0.8940
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 7 [0/469] Loss: 0.3491 Acc: 0.8984 Iters: 50/50
Epoch 7 [100/469] Loss: 0.4610 Acc: 0.9062 Iters: 50/50
Epoch 7 [200/469] Loss: 0.4355 Acc: 0.8359 Iters: 50/50
Epoch 7 [300/469] Loss: 0.3771 Acc: 0.8516 Iters: 50/50
Epoch 7 [400/469] Loss: 0.3551 Acc: 0.8984 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3676, Train Acc: 0.8968
  Test Loss: 0.3485, Test Acc: 0.9003
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 8 [0/469] Loss: 0.3165 Acc: 0.9219 Iters: 50/50
Epoch 8 [100/469] Loss: 0.2492 Acc: 0.9141 Iters: 50/50
Epoch 8 [200/469] Loss: 0.2243 Acc: 0.9453 Iters: 50/50
Epoch 8 [300/469] Loss: 0.4037 Acc: 0.8984 Iters: 50/50
Epoch 8 [400/469] Loss: 0.2890 Acc: 0.9297 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3362, Train Acc: 0.9044
  Test Loss: 0.3127, Test Acc: 0.9124
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 9 [0/469] Loss: 0.3862 Acc: 0.9297 Iters: 50/50
Epoch 9 [100/469] Loss: 0.2239 Acc: 0.8906 Iters: 50/50
Epoch 9 [200/469] Loss: 0.4669 Acc: 0.8828 Iters: 50/50
Epoch 9 [300/469] Loss: 0.4573 Acc: 0.8359 Iters: 50/50
Epoch 9 [400/469] Loss: 0.3440 Acc: 0.8906 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3224, Train Acc: 0.9087
  Test Loss: 0.3058, Test Acc: 0.9108
  Avg Iters: 50.0/50.0
  Time: 64.7s
Epoch 10 [0/469] Loss: 0.3591 Acc: 0.9219 Iters: 50/50
Epoch 10 [100/469] Loss: 0.3634 Acc: 0.9141 Iters: 50/50
Epoch 10 [200/469] Loss: 0.3390 Acc: 0.8750 Iters: 50/50
Epoch 10 [300/469] Loss: 0.2924 Acc: 0.9141 Iters: 50/50
Epoch 10 [400/469] Loss: 0.5087 Acc: 0.8906 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.3172, Train Acc: 0.9096
  Test Loss: 0.3061, Test Acc: 0.9118
  Avg Iters: 50.0/50.0
  Time: 62.6s
Epoch 11 [0/469] Loss: 0.5067 Acc: 0.8750 Iters: 50/50
Epoch 11 [100/469] Loss: 0.3519 Acc: 0.8906 Iters: 50/50
Epoch 11 [200/469] Loss: 0.3277 Acc: 0.9141 Iters: 50/50
Epoch 11 [300/469] Loss: 0.2545 Acc: 0.8906 Iters: 50/50
Epoch 11 [400/469] Loss: 0.2768 Acc: 0.9141 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.3005, Train Acc: 0.9132
  Test Loss: 0.2872, Test Acc: 0.9172
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 12 [0/469] Loss: 0.2606 Acc: 0.9688 Iters: 50/50
Epoch 12 [100/469] Loss: 0.2494 Acc: 0.9297 Iters: 50/50
Epoch 12 [200/469] Loss: 0.2890 Acc: 0.9219 Iters: 50/50
Epoch 12 [300/469] Loss: 0.2344 Acc: 0.9609 Iters: 50/50
Epoch 12 [400/469] Loss: 0.9603 Acc: 0.7188 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.4885, Train Acc: 0.8697
  Test Loss: 0.5730, Test Acc: 0.8383
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 13 [0/469] Loss: 0.6011 Acc: 0.8125 Iters: 50/50
Epoch 13 [100/469] Loss: 0.4952 Acc: 0.8672 Iters: 50/50
Epoch 13 [200/469] Loss: 0.2351 Acc: 0.9375 Iters: 50/50
Epoch 13 [300/469] Loss: 0.3519 Acc: 0.9062 Iters: 50/50
Epoch 13 [400/469] Loss: 0.3279 Acc: 0.8984 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.4057, Train Acc: 0.8865
  Test Loss: 0.3492, Test Acc: 0.8970
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 14 [0/469] Loss: 0.3436 Acc: 0.8750 Iters: 50/50
Epoch 14 [100/469] Loss: 0.4113 Acc: 0.8750 Iters: 50/50
Epoch 14 [200/469] Loss: 0.3743 Acc: 0.8984 Iters: 50/50
Epoch 14 [300/469] Loss: 0.2478 Acc: 0.9219 Iters: 50/50
Epoch 14 [400/469] Loss: 0.2008 Acc: 0.9453 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.3257, Train Acc: 0.9054
  Test Loss: 0.3201, Test Acc: 0.9078
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 15 [0/469] Loss: 0.2927 Acc: 0.9219 Iters: 50/50
Epoch 15 [100/469] Loss: 0.3916 Acc: 0.8750 Iters: 50/50
Epoch 15 [200/469] Loss: 0.2550 Acc: 0.9141 Iters: 50/50
Epoch 15 [300/469] Loss: 0.2333 Acc: 0.9375 Iters: 50/50
Epoch 15 [400/469] Loss: 0.2092 Acc: 0.9531 Iters: 50/50

Epoch 15 Summary:
  Train Loss: 0.3036, Train Acc: 0.9129
  Test Loss: 0.3086, Test Acc: 0.9131
  Avg Iters: 50.0/50.0
  Time: 63.2s
Epoch 16 [0/469] Loss: 0.3310 Acc: 0.8906 Iters: 50/50
Epoch 16 [100/469] Loss: 0.2636 Acc: 0.9453 Iters: 50/50
Epoch 16 [200/469] Loss: 0.4223 Acc: 0.9062 Iters: 50/50
Epoch 16 [300/469] Loss: 0.3173 Acc: 0.9375 Iters: 50/50
Epoch 16 [400/469] Loss: 0.2347 Acc: 0.9062 Iters: 50/50

Epoch 16 Summary:
  Train Loss: 0.3002, Train Acc: 0.9142
  Test Loss: 0.2860, Test Acc: 0.9158
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 17 [0/469] Loss: 0.2352 Acc: 0.9297 Iters: 50/50
Epoch 17 [100/469] Loss: 0.2164 Acc: 0.9453 Iters: 50/50
Epoch 17 [200/469] Loss: 0.2193 Acc: 0.9297 Iters: 50/50
Epoch 17 [300/469] Loss: 0.2648 Acc: 0.9062 Iters: 50/50
Epoch 17 [400/469] Loss: 0.2771 Acc: 0.9375 Iters: 50/50

Epoch 17 Summary:
  Train Loss: 0.2833, Train Acc: 0.9193
  Test Loss: 0.2910, Test Acc: 0.9171
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 18 [0/469] Loss: 0.3503 Acc: 0.9062 Iters: 50/50
Epoch 18 [100/469] Loss: 0.3218 Acc: 0.9297 Iters: 50/50
Epoch 18 [200/469] Loss: 0.1707 Acc: 0.9688 Iters: 50/50
Epoch 18 [300/469] Loss: 0.1128 Acc: 0.9688 Iters: 50/50
Epoch 18 [400/469] Loss: 0.2166 Acc: 0.9297 Iters: 50/50

Epoch 18 Summary:
  Train Loss: 0.2775, Train Acc: 0.9211
  Test Loss: 0.2801, Test Acc: 0.9198
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 19 [0/469] Loss: 0.2131 Acc: 0.9219 Iters: 50/50
Epoch 19 [100/469] Loss: 0.1655 Acc: 0.9375 Iters: 50/50
Epoch 19 [200/469] Loss: 0.1564 Acc: 0.9531 Iters: 50/50
Epoch 19 [300/469] Loss: 0.2762 Acc: 0.8984 Iters: 50/50
Epoch 19 [400/469] Loss: 0.3102 Acc: 0.9219 Iters: 50/50

Epoch 19 Summary:
  Train Loss: 0.2769, Train Acc: 0.9212
  Test Loss: 0.2822, Test Acc: 0.9201
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 20 [0/469] Loss: 0.3047 Acc: 0.9062 Iters: 50/50
Epoch 20 [100/469] Loss: 0.1397 Acc: 0.9688 Iters: 50/50
Epoch 20 [200/469] Loss: 0.3018 Acc: 0.9062 Iters: 50/50
Epoch 20 [300/469] Loss: 0.2521 Acc: 0.9219 Iters: 50/50
Epoch 20 [400/469] Loss: 1.3026 Acc: 0.6250 Iters: 50/50

Epoch 20 Summary:
  Train Loss: 0.6444, Train Acc: 0.8603
  Test Loss: 0.7834, Test Acc: 0.8030
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 21 [0/469] Loss: 0.8397 Acc: 0.7422 Iters: 50/50
Epoch 21 [100/469] Loss: 0.7935 Acc: 0.8203 Iters: 50/50
Epoch 21 [200/469] Loss: 0.4200 Acc: 0.8984 Iters: 50/50
Epoch 21 [300/469] Loss: 0.4470 Acc: 0.8516 Iters: 50/50
Epoch 21 [400/469] Loss: 0.4529 Acc: 0.9062 Iters: 50/50

Epoch 21 Summary:
  Train Loss: 0.5436, Train Acc: 0.8591
  Test Loss: 0.4102, Test Acc: 0.8916
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 22 [0/469] Loss: 0.4239 Acc: 0.8828 Iters: 50/50
Epoch 22 [100/469] Loss: 0.4712 Acc: 0.8672 Iters: 50/50
Epoch 22 [200/469] Loss: 0.4534 Acc: 0.9219 Iters: 50/50
Epoch 22 [300/469] Loss: 0.3315 Acc: 0.8828 Iters: 50/50
Epoch 22 [400/469] Loss: 0.3834 Acc: 0.8672 Iters: 50/50

Epoch 22 Summary:
  Train Loss: 0.3761, Train Acc: 0.8993
  Test Loss: 0.3386, Test Acc: 0.9063
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 23 [0/469] Loss: 0.2444 Acc: 0.9141 Iters: 50/50
Epoch 23 [100/469] Loss: 0.3451 Acc: 0.9375 Iters: 50/50
Epoch 23 [200/469] Loss: 0.2673 Acc: 0.9297 Iters: 50/50
Epoch 23 [300/469] Loss: 0.3439 Acc: 0.8984 Iters: 50/50
Epoch 23 [400/469] Loss: 0.5132 Acc: 0.8828 Iters: 50/50

Epoch 23 Summary:
  Train Loss: 0.3331, Train Acc: 0.9091
  Test Loss: 0.3236, Test Acc: 0.9096
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 24 [0/469] Loss: 0.3049 Acc: 0.8672 Iters: 50/50
Epoch 24 [100/469] Loss: 0.3166 Acc: 0.8828 Iters: 50/50
Epoch 24 [200/469] Loss: 0.2858 Acc: 0.8828 Iters: 50/50
Epoch 24 [300/469] Loss: 0.2604 Acc: 0.9219 Iters: 50/50
Epoch 24 [400/469] Loss: 0.5073 Acc: 0.8984 Iters: 50/50

Epoch 24 Summary:
  Train Loss: 0.3110, Train Acc: 0.9158
  Test Loss: 0.3053, Test Acc: 0.9170
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 25 [0/469] Loss: 0.2386 Acc: 0.9219 Iters: 50/50
Epoch 25 [100/469] Loss: 0.2479 Acc: 0.9297 Iters: 50/50
Epoch 25 [200/469] Loss: 0.3317 Acc: 0.9062 Iters: 50/50
Epoch 25 [300/469] Loss: 0.3368 Acc: 0.9141 Iters: 50/50
Epoch 25 [400/469] Loss: 0.3112 Acc: 0.9062 Iters: 50/50

Epoch 25 Summary:
  Train Loss: 0.2965, Train Acc: 0.9181
  Test Loss: 0.2972, Test Acc: 0.9154
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 26 [0/469] Loss: 0.2326 Acc: 0.9297 Iters: 50/50
Epoch 26 [100/469] Loss: 0.2710 Acc: 0.8984 Iters: 50/50
Epoch 26 [200/469] Loss: 0.2466 Acc: 0.9219 Iters: 50/50
Epoch 26 [300/469] Loss: 0.2034 Acc: 0.9219 Iters: 50/50
Epoch 26 [400/469] Loss: 0.2585 Acc: 0.9062 Iters: 50/50

Epoch 26 Summary:
  Train Loss: 0.2871, Train Acc: 0.9194
  Test Loss: 0.2867, Test Acc: 0.9208
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 27 [0/469] Loss: 0.4987 Acc: 0.8750 Iters: 50/50
Epoch 27 [100/469] Loss: 0.2512 Acc: 0.9141 Iters: 50/50
Epoch 27 [200/469] Loss: 0.2002 Acc: 0.9453 Iters: 50/50
Epoch 27 [300/469] Loss: 0.3571 Acc: 0.9375 Iters: 50/50
Epoch 27 [400/469] Loss: 0.2470 Acc: 0.9219 Iters: 50/50

Epoch 27 Summary:
  Train Loss: 0.2805, Train Acc: 0.9214
  Test Loss: 0.2779, Test Acc: 0.9205
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 28 [0/469] Loss: 0.2168 Acc: 0.9375 Iters: 50/50
Epoch 28 [100/469] Loss: 0.2215 Acc: 0.9219 Iters: 50/50
Epoch 28 [200/469] Loss: 0.2257 Acc: 0.9531 Iters: 50/50
Epoch 28 [300/469] Loss: 0.1909 Acc: 0.9609 Iters: 50/50
Epoch 28 [400/469] Loss: 0.1843 Acc: 0.9531 Iters: 50/50

Epoch 28 Summary:
  Train Loss: 0.2729, Train Acc: 0.9236
  Test Loss: 0.2811, Test Acc: 0.9192
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 29 [0/469] Loss: 0.1764 Acc: 0.9453 Iters: 50/50
Epoch 29 [100/469] Loss: 0.2415 Acc: 0.9297 Iters: 50/50
Epoch 29 [200/469] Loss: 0.1595 Acc: 0.9531 Iters: 50/50
Epoch 29 [300/469] Loss: 0.2008 Acc: 0.9297 Iters: 50/50
Epoch 29 [400/469] Loss: 0.1692 Acc: 0.9297 Iters: 50/50

Epoch 29 Summary:
  Train Loss: 0.2711, Train Acc: 0.9234
  Test Loss: 0.2796, Test Acc: 0.9212
  Avg Iters: 50.0/50.0
  Time: 64.5s

======================================================================
Training complete! Best test accuracy: 0.9212
======================================================================
