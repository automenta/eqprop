======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.22, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 3.2326 Acc: 0.1406 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2831 Acc: 0.0703 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2783 Acc: 0.0938 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2820 Acc: 0.1406 Iters: 50/50
Epoch 0 [400/469] Loss: 2.2545 Acc: 0.2422 Iters: 50/50
W1229 06:08:07.966000 705194 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1229 06:08:07.966000 705194 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1229 06:08:07.966000 705194 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1229 06:08:07.966000 705194 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1229 06:08:07.966000 705194 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.2588, Train Acc: 0.1829
  Test Loss: 2.1176, Test Acc: 0.2620
  Avg Iters: 50.0/50.0
  Time: 67.2s
Epoch 1 [0/469] Loss: 2.1390 Acc: 0.2578 Iters: 50/50
Epoch 1 [100/469] Loss: 1.9207 Acc: 0.3203 Iters: 50/50
Epoch 1 [200/469] Loss: 1.5150 Acc: 0.5078 Iters: 50/50
Epoch 1 [300/469] Loss: 1.3104 Acc: 0.5312 Iters: 50/50
Epoch 1 [400/469] Loss: 1.0306 Acc: 0.6797 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.4833, Train Acc: 0.5047
  Test Loss: 0.9462, Test Acc: 0.6725
  Avg Iters: 50.0/50.0
  Time: 64.7s
Epoch 2 [0/469] Loss: 0.9348 Acc: 0.6250 Iters: 50/50
Epoch 2 [100/469] Loss: 0.7211 Acc: 0.7656 Iters: 50/50
Epoch 2 [200/469] Loss: 0.6197 Acc: 0.7578 Iters: 50/50
Epoch 2 [300/469] Loss: 0.6956 Acc: 0.7500 Iters: 50/50
Epoch 2 [400/469] Loss: 0.5835 Acc: 0.8281 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.7579, Train Acc: 0.7551
  Test Loss: 0.6113, Test Acc: 0.8119
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 3 [0/469] Loss: 0.7073 Acc: 0.7969 Iters: 50/50
Epoch 3 [100/469] Loss: 0.7353 Acc: 0.8125 Iters: 50/50
Epoch 3 [200/469] Loss: 0.7518 Acc: 0.7656 Iters: 50/50
Epoch 3 [300/469] Loss: 0.3719 Acc: 0.8828 Iters: 50/50
Epoch 3 [400/469] Loss: 0.5242 Acc: 0.8125 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.5472, Train Acc: 0.8350
  Test Loss: 0.4718, Test Acc: 0.8595
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 4 [0/469] Loss: 0.4213 Acc: 0.8750 Iters: 50/50
Epoch 4 [100/469] Loss: 0.3842 Acc: 0.8750 Iters: 50/50
Epoch 4 [200/469] Loss: 0.5043 Acc: 0.8359 Iters: 50/50
Epoch 4 [300/469] Loss: 0.3770 Acc: 0.9297 Iters: 50/50
Epoch 4 [400/469] Loss: 0.3979 Acc: 0.8438 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4523, Train Acc: 0.8690
  Test Loss: 0.4305, Test Acc: 0.8717
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 5 [0/469] Loss: 0.3807 Acc: 0.8828 Iters: 50/50
Epoch 5 [100/469] Loss: 0.3159 Acc: 0.8906 Iters: 50/50
Epoch 5 [200/469] Loss: 0.3357 Acc: 0.8984 Iters: 50/50
Epoch 5 [300/469] Loss: 0.4642 Acc: 0.8750 Iters: 50/50
Epoch 5 [400/469] Loss: 0.4915 Acc: 0.8359 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3995, Train Acc: 0.8858
  Test Loss: 0.3823, Test Acc: 0.8916
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 6 [0/469] Loss: 0.2824 Acc: 0.9062 Iters: 50/50
Epoch 6 [100/469] Loss: 0.2483 Acc: 0.9375 Iters: 50/50
Epoch 6 [200/469] Loss: 0.2305 Acc: 0.9062 Iters: 50/50
Epoch 6 [300/469] Loss: 0.4664 Acc: 0.8828 Iters: 50/50
Epoch 6 [400/469] Loss: 0.3334 Acc: 0.8984 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3688, Train Acc: 0.8956
  Test Loss: 0.3499, Test Acc: 0.9022
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 7 [0/469] Loss: 0.3482 Acc: 0.8906 Iters: 50/50
Epoch 7 [100/469] Loss: 0.3237 Acc: 0.8828 Iters: 50/50
Epoch 7 [200/469] Loss: 0.4653 Acc: 0.8984 Iters: 50/50
Epoch 7 [300/469] Loss: 0.3464 Acc: 0.9062 Iters: 50/50
Epoch 7 [400/469] Loss: 0.4275 Acc: 0.8906 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3341, Train Acc: 0.9053
  Test Loss: 0.3173, Test Acc: 0.9090
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 8 [0/469] Loss: 0.3573 Acc: 0.9375 Iters: 50/50
Epoch 8 [100/469] Loss: 0.3080 Acc: 0.9453 Iters: 50/50
Epoch 8 [200/469] Loss: 0.3677 Acc: 0.9062 Iters: 50/50
Epoch 8 [300/469] Loss: 0.2831 Acc: 0.9453 Iters: 50/50
Epoch 8 [400/469] Loss: 0.2929 Acc: 0.9062 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3153, Train Acc: 0.9095
  Test Loss: 0.3307, Test Acc: 0.9023
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 9 [0/469] Loss: 0.1846 Acc: 0.9297 Iters: 50/50
Epoch 9 [100/469] Loss: 0.2902 Acc: 0.9219 Iters: 50/50
Epoch 9 [200/469] Loss: 0.1745 Acc: 0.9531 Iters: 50/50
Epoch 9 [300/469] Loss: 0.2326 Acc: 0.9219 Iters: 50/50
Epoch 9 [400/469] Loss: 0.1983 Acc: 0.9375 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3062, Train Acc: 0.9122
  Test Loss: 0.3080, Test Acc: 0.9104
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 10 [0/469] Loss: 0.2797 Acc: 0.9141 Iters: 50/50
Epoch 10 [100/469] Loss: 0.2610 Acc: 0.9375 Iters: 50/50
Epoch 10 [200/469] Loss: 0.3806 Acc: 0.8984 Iters: 50/50
Epoch 10 [300/469] Loss: 0.2136 Acc: 0.9297 Iters: 50/50
Epoch 10 [400/469] Loss: 0.3228 Acc: 0.8828 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.2997, Train Acc: 0.9128
  Test Loss: 0.2890, Test Acc: 0.9162
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 11 [0/469] Loss: 0.2856 Acc: 0.9219 Iters: 50/50
Epoch 11 [100/469] Loss: 0.2986 Acc: 0.9062 Iters: 50/50
Epoch 11 [200/469] Loss: 0.5149 Acc: 0.8906 Iters: 50/50
Epoch 11 [300/469] Loss: 0.2611 Acc: 0.9531 Iters: 50/50
Epoch 11 [400/469] Loss: 0.3147 Acc: 0.8984 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.2956, Train Acc: 0.9149
  Test Loss: 0.2962, Test Acc: 0.9117
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 12 [0/469] Loss: 0.2955 Acc: 0.8984 Iters: 50/50
Epoch 12 [100/469] Loss: 0.2488 Acc: 0.9297 Iters: 50/50
Epoch 12 [200/469] Loss: 0.1744 Acc: 0.9453 Iters: 50/50
Epoch 12 [300/469] Loss: 0.2926 Acc: 0.9375 Iters: 50/50
Epoch 12 [400/469] Loss: 0.1987 Acc: 0.9219 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.2798, Train Acc: 0.9193
  Test Loss: 0.2961, Test Acc: 0.9170
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 13 [0/469] Loss: 0.2832 Acc: 0.8906 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2590 Acc: 0.9297 Iters: 50/50
Epoch 13 [200/469] Loss: 0.3271 Acc: 0.8750 Iters: 50/50
Epoch 13 [300/469] Loss: 0.1911 Acc: 0.9531 Iters: 50/50
Epoch 13 [400/469] Loss: 1.4077 Acc: 0.4688 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.4562, Train Acc: 0.8751
  Test Loss: 0.6527, Test Acc: 0.8416
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 14 [0/469] Loss: 0.5917 Acc: 0.8672 Iters: 50/50
Epoch 14 [100/469] Loss: 0.3275 Acc: 0.9062 Iters: 50/50
Epoch 14 [200/469] Loss: 0.4469 Acc: 0.8828 Iters: 50/50
Epoch 14 [300/469] Loss: 0.3432 Acc: 0.8984 Iters: 50/50
Epoch 14 [400/469] Loss: 0.3751 Acc: 0.8672 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.4047, Train Acc: 0.8908
  Test Loss: 0.3586, Test Acc: 0.9043
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 15 [0/469] Loss: 0.4287 Acc: 0.8750 Iters: 50/50
Epoch 15 [100/469] Loss: 0.3337 Acc: 0.8984 Iters: 50/50
Epoch 15 [200/469] Loss: 0.3746 Acc: 0.8594 Iters: 50/50
Epoch 15 [300/469] Loss: 0.2846 Acc: 0.9141 Iters: 50/50
Epoch 15 [400/469] Loss: 0.4703 Acc: 0.8828 Iters: 50/50

Epoch 15 Summary:
  Train Loss: 0.3268, Train Acc: 0.9103
  Test Loss: 0.3139, Test Acc: 0.9152
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 16 [0/469] Loss: 0.2428 Acc: 0.9453 Iters: 50/50
Epoch 16 [100/469] Loss: 0.4639 Acc: 0.8750 Iters: 50/50
Epoch 16 [200/469] Loss: 0.3779 Acc: 0.9062 Iters: 50/50
Epoch 16 [300/469] Loss: 0.3702 Acc: 0.9219 Iters: 50/50
Epoch 16 [400/469] Loss: 0.3334 Acc: 0.9141 Iters: 50/50

Epoch 16 Summary:
  Train Loss: 0.3032, Train Acc: 0.9157
  Test Loss: 0.3016, Test Acc: 0.9148
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 17 [0/469] Loss: 0.2968 Acc: 0.9219 Iters: 50/50
Epoch 17 [100/469] Loss: 0.3309 Acc: 0.9062 Iters: 50/50
Epoch 17 [200/469] Loss: 0.2267 Acc: 0.9531 Iters: 50/50
Epoch 17 [300/469] Loss: 0.2636 Acc: 0.9062 Iters: 50/50
Epoch 17 [400/469] Loss: 0.1817 Acc: 0.9297 Iters: 50/50

Epoch 17 Summary:
  Train Loss: 0.2928, Train Acc: 0.9176
  Test Loss: 0.2933, Test Acc: 0.9157
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 18 [0/469] Loss: 0.2845 Acc: 0.9141 Iters: 50/50
Epoch 18 [100/469] Loss: 0.3097 Acc: 0.8984 Iters: 50/50
Epoch 18 [200/469] Loss: 0.2278 Acc: 0.9219 Iters: 50/50
Epoch 18 [300/469] Loss: 0.2999 Acc: 0.9141 Iters: 50/50
Epoch 18 [400/469] Loss: 0.2311 Acc: 0.9375 Iters: 50/50

Epoch 18 Summary:
  Train Loss: 0.2838, Train Acc: 0.9198
  Test Loss: 0.3101, Test Acc: 0.9133
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 19 [0/469] Loss: 0.2905 Acc: 0.9062 Iters: 50/50
Epoch 19 [100/469] Loss: 0.3195 Acc: 0.8828 Iters: 50/50
Epoch 19 [200/469] Loss: 0.3164 Acc: 0.9297 Iters: 50/50
Epoch 19 [300/469] Loss: 0.2656 Acc: 0.9141 Iters: 50/50
Epoch 19 [400/469] Loss: 0.2087 Acc: 0.9375 Iters: 50/50

Epoch 19 Summary:
  Train Loss: 0.2785, Train Acc: 0.9206
  Test Loss: 0.2990, Test Acc: 0.9170
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 20 [0/469] Loss: 0.1779 Acc: 0.9375 Iters: 50/50
Epoch 20 [100/469] Loss: 0.4952 Acc: 0.8906 Iters: 50/50
Epoch 20 [200/469] Loss: 0.2346 Acc: 0.9219 Iters: 50/50
Epoch 20 [300/469] Loss: 0.2616 Acc: 0.9375 Iters: 50/50
Epoch 20 [400/469] Loss: 0.3761 Acc: 0.8906 Iters: 50/50

Epoch 20 Summary:
  Train Loss: 0.2748, Train Acc: 0.9225
  Test Loss: 0.2917, Test Acc: 0.9149
  Avg Iters: 50.0/50.0
  Time: 65.0s
Epoch 21 [0/469] Loss: 0.3034 Acc: 0.9141 Iters: 50/50
Epoch 21 [100/469] Loss: 0.2738 Acc: 0.9062 Iters: 50/50
Epoch 21 [200/469] Loss: 0.2733 Acc: 0.9141 Iters: 50/50
Epoch 21 [300/469] Loss: 0.3378 Acc: 0.8984 Iters: 50/50
Epoch 21 [400/469] Loss: 0.4590 Acc: 0.8906 Iters: 50/50

Epoch 21 Summary:
  Train Loss: 0.2702, Train Acc: 0.9219
  Test Loss: 0.2832, Test Acc: 0.9214
  Avg Iters: 50.0/50.0
  Time: 68.5s
Epoch 22 [0/469] Loss: 0.2591 Acc: 0.9297 Iters: 50/50
Epoch 22 [100/469] Loss: 0.1527 Acc: 0.9375 Iters: 50/50
Epoch 22 [200/469] Loss: 0.2223 Acc: 0.9375 Iters: 50/50
Epoch 22 [300/469] Loss: 0.3074 Acc: 0.9219 Iters: 50/50
Epoch 22 [400/469] Loss: 0.2680 Acc: 0.9297 Iters: 50/50

Epoch 22 Summary:
  Train Loss: 0.2679, Train Acc: 0.9240
  Test Loss: 0.2914, Test Acc: 0.9140
  Avg Iters: 50.0/50.0
  Time: 65.6s
Epoch 23 [0/469] Loss: 0.2369 Acc: 0.8984 Iters: 50/50
Epoch 23 [100/469] Loss: 0.3392 Acc: 0.9062 Iters: 50/50
Epoch 23 [200/469] Loss: 0.4464 Acc: 0.8906 Iters: 50/50
Epoch 23 [300/469] Loss: 0.2697 Acc: 0.9219 Iters: 50/50
Epoch 23 [400/469] Loss: 0.2174 Acc: 0.9453 Iters: 50/50

Epoch 23 Summary:
  Train Loss: 0.2644, Train Acc: 0.9242
  Test Loss: 0.2610, Test Acc: 0.9240
  Avg Iters: 50.0/50.0
  Time: 66.8s
Epoch 24 [0/469] Loss: 0.1962 Acc: 0.9453 Iters: 50/50
Epoch 24 [100/469] Loss: 0.3141 Acc: 0.8906 Iters: 50/50
Epoch 24 [200/469] Loss: 0.2701 Acc: 0.9297 Iters: 50/50
Epoch 24 [300/469] Loss: 0.2602 Acc: 0.9141 Iters: 50/50
Epoch 24 [400/469] Loss: 0.3826 Acc: 0.8906 Iters: 50/50

Epoch 24 Summary:
  Train Loss: 0.2630, Train Acc: 0.9233
  Test Loss: 0.2748, Test Acc: 0.9210
  Avg Iters: 50.0/50.0
  Time: 65.2s
Epoch 25 [0/469] Loss: 0.3126 Acc: 0.9141 Iters: 50/50
Epoch 25 [100/469] Loss: 0.2100 Acc: 0.9219 Iters: 50/50
Epoch 25 [200/469] Loss: 0.1685 Acc: 0.9375 Iters: 50/50
Epoch 25 [300/469] Loss: 0.3089 Acc: 0.9141 Iters: 50/50
Epoch 25 [400/469] Loss: 0.3694 Acc: 0.8984 Iters: 50/50

Epoch 25 Summary:
  Train Loss: 0.2602, Train Acc: 0.9249
  Test Loss: 0.2751, Test Acc: 0.9225
  Avg Iters: 50.0/50.0
  Time: 67.0s
Epoch 26 [0/469] Loss: 0.1703 Acc: 0.9688 Iters: 50/50
Epoch 26 [100/469] Loss: 0.3285 Acc: 0.9062 Iters: 50/50
Epoch 26 [200/469] Loss: 0.4004 Acc: 0.9219 Iters: 50/50
Epoch 26 [300/469] Loss: 0.1883 Acc: 0.9531 Iters: 50/50
Epoch 26 [400/469] Loss: 0.2920 Acc: 0.8984 Iters: 50/50

Epoch 26 Summary:
  Train Loss: 0.2756, Train Acc: 0.9230
  Test Loss: 0.2903, Test Acc: 0.9205
  Avg Iters: 50.0/50.0
  Time: 66.5s
Epoch 27 [0/469] Loss: 0.2909 Acc: 0.9453 Iters: 50/50
Epoch 27 [100/469] Loss: 0.2329 Acc: 0.9141 Iters: 50/50
Epoch 27 [200/469] Loss: 0.2615 Acc: 0.9219 Iters: 50/50
Epoch 27 [300/469] Loss: 0.2533 Acc: 0.9297 Iters: 50/50
Epoch 27 [400/469] Loss: 0.3773 Acc: 0.9141 Iters: 50/50

Epoch 27 Summary:
  Train Loss: 0.2593, Train Acc: 0.9255
  Test Loss: 0.3035, Test Acc: 0.9119
  Avg Iters: 50.0/50.0
  Time: 65.0s
Epoch 28 [0/469] Loss: 0.2350 Acc: 0.9297 Iters: 50/50
Epoch 28 [100/469] Loss: 0.2045 Acc: 0.9297 Iters: 50/50
Epoch 28 [200/469] Loss: 0.2364 Acc: 0.9297 Iters: 50/50
Epoch 28 [300/469] Loss: 0.3663 Acc: 0.8828 Iters: 50/50
Epoch 28 [400/469] Loss: 0.3601 Acc: 0.8828 Iters: 50/50

Epoch 28 Summary:
  Train Loss: 0.2629, Train Acc: 0.9243
  Test Loss: 0.2800, Test Acc: 0.9178
  Avg Iters: 50.0/50.0
  Time: 65.3s
Epoch 29 [0/469] Loss: 0.4123 Acc: 0.8828 Iters: 50/50
Epoch 29 [100/469] Loss: 0.1912 Acc: 0.9688 Iters: 50/50
Epoch 29 [200/469] Loss: 0.3312 Acc: 0.9062 Iters: 50/50
Epoch 29 [300/469] Loss: 0.3641 Acc: 0.9141 Iters: 50/50
Epoch 29 [400/469] Loss: 0.2266 Acc: 0.9375 Iters: 50/50

Epoch 29 Summary:
  Train Loss: 0.2537, Train Acc: 0.9263
  Test Loss: 0.2585, Test Acc: 0.9251
  Avg Iters: 50.0/50.0
  Time: 64.5s

======================================================================
Training complete! Best test accuracy: 0.9251
======================================================================
