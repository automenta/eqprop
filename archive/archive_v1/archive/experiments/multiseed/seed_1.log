======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.22, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 3.2883 Acc: 0.2188 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2604 Acc: 0.2422 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2283 Acc: 0.0938 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2252 Acc: 0.1797 Iters: 50/50
Epoch 0 [400/469] Loss: 2.0039 Acc: 0.4062 Iters: 50/50
W1229 05:01:24.886000 692224 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1229 05:01:24.886000 692224 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1229 05:01:24.886000 692224 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1229 05:01:24.886000 692224 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1229 05:01:24.886000 692224 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.1843, Train Acc: 0.2457
  Test Loss: 1.8783, Test Acc: 0.3913
  Avg Iters: 50.0/50.0
  Time: 66.0s
Epoch 1 [0/469] Loss: 1.7711 Acc: 0.4453 Iters: 50/50
Epoch 1 [100/469] Loss: 1.4285 Acc: 0.4922 Iters: 50/50
Epoch 1 [200/469] Loss: 1.2609 Acc: 0.5156 Iters: 50/50
Epoch 1 [300/469] Loss: 1.0343 Acc: 0.6406 Iters: 50/50
Epoch 1 [400/469] Loss: 0.9139 Acc: 0.7422 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.2305, Train Acc: 0.5789
  Test Loss: 0.8433, Test Acc: 0.7441
  Avg Iters: 50.0/50.0
  Time: 62.9s
Epoch 2 [0/469] Loss: 0.7598 Acc: 0.8047 Iters: 50/50
Epoch 2 [100/469] Loss: 0.8602 Acc: 0.7031 Iters: 50/50
Epoch 2 [200/469] Loss: 0.6794 Acc: 0.7734 Iters: 50/50
Epoch 2 [300/469] Loss: 0.7458 Acc: 0.7344 Iters: 50/50
Epoch 2 [400/469] Loss: 0.5795 Acc: 0.7812 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.6838, Train Acc: 0.7909
  Test Loss: 0.5788, Test Acc: 0.8317
  Avg Iters: 50.0/50.0
  Time: 62.8s
Epoch 3 [0/469] Loss: 0.5082 Acc: 0.8672 Iters: 50/50
Epoch 3 [100/469] Loss: 0.5907 Acc: 0.7891 Iters: 50/50
Epoch 3 [200/469] Loss: 0.5849 Acc: 0.8203 Iters: 50/50
Epoch 3 [300/469] Loss: 0.4713 Acc: 0.8203 Iters: 50/50
Epoch 3 [400/469] Loss: 0.5477 Acc: 0.8203 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.5265, Train Acc: 0.8461
  Test Loss: 0.4858, Test Acc: 0.8509
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 4 [0/469] Loss: 0.5217 Acc: 0.8906 Iters: 50/50
Epoch 4 [100/469] Loss: 0.4641 Acc: 0.8672 Iters: 50/50
Epoch 4 [200/469] Loss: 0.4949 Acc: 0.8672 Iters: 50/50
Epoch 4 [300/469] Loss: 0.4238 Acc: 0.8750 Iters: 50/50
Epoch 4 [400/469] Loss: 0.4019 Acc: 0.8828 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4430, Train Acc: 0.8719
  Test Loss: 0.4129, Test Acc: 0.8806
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 5 [0/469] Loss: 0.3285 Acc: 0.9062 Iters: 50/50
Epoch 5 [100/469] Loss: 0.4133 Acc: 0.8438 Iters: 50/50
Epoch 5 [200/469] Loss: 0.4449 Acc: 0.8281 Iters: 50/50
Epoch 5 [300/469] Loss: 0.4851 Acc: 0.8906 Iters: 50/50
Epoch 5 [400/469] Loss: 0.2755 Acc: 0.9375 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3857, Train Acc: 0.8895
  Test Loss: 0.3569, Test Acc: 0.8991
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 6 [0/469] Loss: 0.3978 Acc: 0.8984 Iters: 50/50
Epoch 6 [100/469] Loss: 0.4259 Acc: 0.8750 Iters: 50/50
Epoch 6 [200/469] Loss: 0.3519 Acc: 0.8984 Iters: 50/50
Epoch 6 [300/469] Loss: 0.3671 Acc: 0.8672 Iters: 50/50
Epoch 6 [400/469] Loss: 0.4194 Acc: 0.8594 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3593, Train Acc: 0.8964
  Test Loss: 0.3327, Test Acc: 0.9041
  Avg Iters: 50.0/50.0
  Time: 64.7s
Epoch 7 [0/469] Loss: 0.2345 Acc: 0.9297 Iters: 50/50
Epoch 7 [100/469] Loss: 0.3966 Acc: 0.8750 Iters: 50/50
Epoch 7 [200/469] Loss: 0.3046 Acc: 0.9297 Iters: 50/50
Epoch 7 [300/469] Loss: 0.3789 Acc: 0.8828 Iters: 50/50
Epoch 7 [400/469] Loss: 0.2980 Acc: 0.9141 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3335, Train Acc: 0.9053
  Test Loss: 0.3283, Test Acc: 0.9058
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 8 [0/469] Loss: 0.2135 Acc: 0.9453 Iters: 50/50
Epoch 8 [100/469] Loss: 0.2395 Acc: 0.9141 Iters: 50/50
Epoch 8 [200/469] Loss: 0.3461 Acc: 0.8984 Iters: 50/50
Epoch 8 [300/469] Loss: 0.2412 Acc: 0.8984 Iters: 50/50
Epoch 8 [400/469] Loss: 0.2631 Acc: 0.8984 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3142, Train Acc: 0.9102
  Test Loss: 0.3563, Test Acc: 0.8928
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 9 [0/469] Loss: 0.2079 Acc: 0.9375 Iters: 50/50
Epoch 9 [100/469] Loss: 0.4280 Acc: 0.8750 Iters: 50/50
Epoch 9 [200/469] Loss: 0.2874 Acc: 0.9062 Iters: 50/50
Epoch 9 [300/469] Loss: 0.2546 Acc: 0.9375 Iters: 50/50
Epoch 9 [400/469] Loss: 0.2549 Acc: 0.9141 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3029, Train Acc: 0.9138
  Test Loss: 0.3281, Test Acc: 0.9045
  Avg Iters: 50.0/50.0
  Time: 65.7s
Epoch 10 [0/469] Loss: 0.4072 Acc: 0.9062 Iters: 50/50
Epoch 10 [100/469] Loss: 0.3098 Acc: 0.9141 Iters: 50/50
Epoch 10 [200/469] Loss: 0.2761 Acc: 0.9219 Iters: 50/50
Epoch 10 [300/469] Loss: 0.3932 Acc: 0.8359 Iters: 50/50
Epoch 10 [400/469] Loss: 0.4146 Acc: 0.8672 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.3232, Train Acc: 0.9072
  Test Loss: 0.3017, Test Acc: 0.9131
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 11 [0/469] Loss: 0.3821 Acc: 0.8984 Iters: 50/50
Epoch 11 [100/469] Loss: 0.1771 Acc: 0.9453 Iters: 50/50
Epoch 11 [200/469] Loss: 0.2777 Acc: 0.9375 Iters: 50/50
Epoch 11 [300/469] Loss: 0.4693 Acc: 0.8984 Iters: 50/50
Epoch 11 [400/469] Loss: 0.2435 Acc: 0.9453 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.3091, Train Acc: 0.9126
  Test Loss: 0.2867, Test Acc: 0.9189
  Avg Iters: 50.0/50.0
  Time: 64.8s
Epoch 12 [0/469] Loss: 0.3171 Acc: 0.8984 Iters: 50/50
Epoch 12 [100/469] Loss: 0.3254 Acc: 0.9141 Iters: 50/50
Epoch 12 [200/469] Loss: 0.2932 Acc: 0.8984 Iters: 50/50
Epoch 12 [300/469] Loss: 0.2371 Acc: 0.9453 Iters: 50/50
Epoch 12 [400/469] Loss: 0.3381 Acc: 0.8828 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.2918, Train Acc: 0.9175
  Test Loss: 0.2827, Test Acc: 0.9203
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 13 [0/469] Loss: 0.2927 Acc: 0.9141 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2575 Acc: 0.9219 Iters: 50/50
Epoch 13 [200/469] Loss: 0.2960 Acc: 0.8984 Iters: 50/50
Epoch 13 [300/469] Loss: 0.4799 Acc: 0.8906 Iters: 50/50
Epoch 13 [400/469] Loss: 0.1607 Acc: 0.9531 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.2808, Train Acc: 0.9202
  Test Loss: 0.2853, Test Acc: 0.9177
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 14 [0/469] Loss: 0.2197 Acc: 0.9219 Iters: 50/50
Epoch 14 [100/469] Loss: 0.2463 Acc: 0.9297 Iters: 50/50
Epoch 14 [200/469] Loss: 0.1845 Acc: 0.9219 Iters: 50/50
Epoch 14 [300/469] Loss: 0.3974 Acc: 0.9062 Iters: 50/50
Epoch 14 [400/469] Loss: 0.2831 Acc: 0.8906 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.2774, Train Acc: 0.9195
  Test Loss: 0.2806, Test Acc: 0.9209
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 15 [0/469] Loss: 0.1440 Acc: 0.9688 Iters: 50/50
Epoch 15 [100/469] Loss: 0.4845 Acc: 0.8984 Iters: 50/50
Epoch 15 [200/469] Loss: 0.5352 Acc: 0.8359 Iters: 50/50
Epoch 15 [300/469] Loss: 0.3691 Acc: 0.9141 Iters: 50/50
Epoch 15 [400/469] Loss: 0.2681 Acc: 0.9141 Iters: 50/50

Epoch 15 Summary:
  Train Loss: 0.3643, Train Acc: 0.8979
  Test Loss: 0.3061, Test Acc: 0.9140
  Avg Iters: 50.0/50.0
  Time: 64.7s
Epoch 16 [0/469] Loss: 0.3191 Acc: 0.9141 Iters: 50/50
Epoch 16 [100/469] Loss: 0.4350 Acc: 0.8984 Iters: 50/50
Epoch 16 [200/469] Loss: 0.4227 Acc: 0.8906 Iters: 50/50
Epoch 16 [300/469] Loss: 0.2432 Acc: 0.9219 Iters: 50/50
Epoch 16 [400/469] Loss: 0.2716 Acc: 0.9375 Iters: 50/50

Epoch 16 Summary:
  Train Loss: 0.2938, Train Acc: 0.9157
  Test Loss: 0.2870, Test Acc: 0.9173
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 17 [0/469] Loss: 0.4215 Acc: 0.8984 Iters: 50/50
Epoch 17 [100/469] Loss: 0.3112 Acc: 0.9219 Iters: 50/50
Epoch 17 [200/469] Loss: 0.2736 Acc: 0.9062 Iters: 50/50
Epoch 17 [300/469] Loss: 0.3181 Acc: 0.9219 Iters: 50/50
Epoch 17 [400/469] Loss: 0.4281 Acc: 0.8750 Iters: 50/50

Epoch 17 Summary:
  Train Loss: 0.2771, Train Acc: 0.9213
  Test Loss: 0.2818, Test Acc: 0.9187
  Avg Iters: 50.0/50.0
  Time: 64.8s
Epoch 18 [0/469] Loss: 0.2014 Acc: 0.9141 Iters: 50/50
Epoch 18 [100/469] Loss: 0.1548 Acc: 0.9453 Iters: 50/50
Epoch 18 [200/469] Loss: 0.2230 Acc: 0.9297 Iters: 50/50
Epoch 18 [300/469] Loss: 0.2340 Acc: 0.9453 Iters: 50/50
Epoch 18 [400/469] Loss: 0.3107 Acc: 0.9141 Iters: 50/50

Epoch 18 Summary:
  Train Loss: 0.2722, Train Acc: 0.9223
  Test Loss: 0.3209, Test Acc: 0.9052
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 19 [0/469] Loss: 0.2747 Acc: 0.9219 Iters: 50/50
Epoch 19 [100/469] Loss: 0.1450 Acc: 0.9609 Iters: 50/50
Epoch 19 [200/469] Loss: 0.1575 Acc: 0.9766 Iters: 50/50
Epoch 19 [300/469] Loss: 0.1523 Acc: 0.9453 Iters: 50/50
Epoch 19 [400/469] Loss: 0.2590 Acc: 0.9141 Iters: 50/50

Epoch 19 Summary:
  Train Loss: 0.2690, Train Acc: 0.9230
  Test Loss: 0.3160, Test Acc: 0.9091
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 20 [0/469] Loss: 0.4436 Acc: 0.8906 Iters: 50/50
Epoch 20 [100/469] Loss: 0.1946 Acc: 0.9375 Iters: 50/50
Epoch 20 [200/469] Loss: 0.4425 Acc: 0.9062 Iters: 50/50
Epoch 20 [300/469] Loss: 0.2011 Acc: 0.9141 Iters: 50/50
Epoch 20 [400/469] Loss: 0.2961 Acc: 0.9062 Iters: 50/50

Epoch 20 Summary:
  Train Loss: 0.2656, Train Acc: 0.9236
  Test Loss: 0.2792, Test Acc: 0.9211
  Avg Iters: 50.0/50.0
  Time: 62.9s
Epoch 21 [0/469] Loss: 0.3781 Acc: 0.8906 Iters: 50/50
Epoch 21 [100/469] Loss: 0.4943 Acc: 0.8438 Iters: 50/50
Epoch 21 [200/469] Loss: 0.1840 Acc: 0.9297 Iters: 50/50
Epoch 21 [300/469] Loss: 0.3292 Acc: 0.8906 Iters: 50/50
Epoch 21 [400/469] Loss: 0.2233 Acc: 0.9141 Iters: 50/50

Epoch 21 Summary:
  Train Loss: 0.2635, Train Acc: 0.9228
  Test Loss: 0.2710, Test Acc: 0.9205
  Avg Iters: 50.0/50.0
  Time: 62.9s
Epoch 22 [0/469] Loss: 0.5072 Acc: 0.8438 Iters: 50/50
Epoch 22 [100/469] Loss: 0.2704 Acc: 0.9297 Iters: 50/50
Epoch 22 [200/469] Loss: 0.2427 Acc: 0.9297 Iters: 50/50
Epoch 22 [300/469] Loss: 0.1674 Acc: 0.9453 Iters: 50/50
Epoch 22 [400/469] Loss: 0.1592 Acc: 0.9531 Iters: 50/50

Epoch 22 Summary:
  Train Loss: 0.2647, Train Acc: 0.9240
  Test Loss: 0.7219, Test Acc: 0.8028
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 23 [0/469] Loss: 0.5965 Acc: 0.8281 Iters: 50/50
Epoch 23 [100/469] Loss: 1.0393 Acc: 0.7266 Iters: 50/50
Epoch 23 [200/469] Loss: 0.5957 Acc: 0.8516 Iters: 50/50
Epoch 23 [300/469] Loss: 0.4885 Acc: 0.8594 Iters: 50/50
Epoch 23 [400/469] Loss: 0.4435 Acc: 0.8750 Iters: 50/50

Epoch 23 Summary:
  Train Loss: 0.7346, Train Acc: 0.8008
  Test Loss: 0.3987, Test Acc: 0.8937
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 24 [0/469] Loss: 0.5103 Acc: 0.8828 Iters: 50/50
Epoch 24 [100/469] Loss: 0.3440 Acc: 0.8906 Iters: 50/50
Epoch 24 [200/469] Loss: 0.4060 Acc: 0.8750 Iters: 50/50
Epoch 24 [300/469] Loss: 0.1955 Acc: 0.9453 Iters: 50/50
Epoch 24 [400/469] Loss: 0.2557 Acc: 0.8984 Iters: 50/50

Epoch 24 Summary:
  Train Loss: 0.3472, Train Acc: 0.9026
  Test Loss: 0.3409, Test Acc: 0.9080
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 25 [0/469] Loss: 0.3690 Acc: 0.9375 Iters: 50/50
Epoch 25 [100/469] Loss: 0.3683 Acc: 0.9141 Iters: 50/50
Epoch 25 [200/469] Loss: 0.1732 Acc: 0.9453 Iters: 50/50
Epoch 25 [300/469] Loss: 0.2516 Acc: 0.9219 Iters: 50/50
Epoch 25 [400/469] Loss: 0.3484 Acc: 0.9375 Iters: 50/50

Epoch 25 Summary:
  Train Loss: 0.3138, Train Acc: 0.9128
  Test Loss: 0.3044, Test Acc: 0.9180
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 26 [0/469] Loss: 0.3464 Acc: 0.9141 Iters: 50/50
Epoch 26 [100/469] Loss: 0.1946 Acc: 0.9219 Iters: 50/50
Epoch 26 [200/469] Loss: 0.1827 Acc: 0.9219 Iters: 50/50
Epoch 26 [300/469] Loss: 0.2004 Acc: 0.9453 Iters: 50/50
Epoch 26 [400/469] Loss: 0.2624 Acc: 0.9219 Iters: 50/50

Epoch 26 Summary:
  Train Loss: 0.2909, Train Acc: 0.9181
  Test Loss: 0.3076, Test Acc: 0.9140
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 27 [0/469] Loss: 0.2382 Acc: 0.9219 Iters: 50/50
Epoch 27 [100/469] Loss: 0.3998 Acc: 0.8984 Iters: 50/50
Epoch 27 [200/469] Loss: 0.3738 Acc: 0.8984 Iters: 50/50
Epoch 27 [300/469] Loss: 0.3206 Acc: 0.8984 Iters: 50/50
Epoch 27 [400/469] Loss: 0.2038 Acc: 0.9375 Iters: 50/50

Epoch 27 Summary:
  Train Loss: 0.3038, Train Acc: 0.9155
  Test Loss: 0.3140, Test Acc: 0.9098
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 28 [0/469] Loss: 0.5334 Acc: 0.9062 Iters: 50/50
Epoch 28 [100/469] Loss: 0.3887 Acc: 0.8516 Iters: 50/50
Epoch 28 [200/469] Loss: 0.4857 Acc: 0.9062 Iters: 50/50
Epoch 28 [300/469] Loss: 0.2396 Acc: 0.9453 Iters: 50/50
Epoch 28 [400/469] Loss: 0.2325 Acc: 0.9375 Iters: 50/50

Epoch 28 Summary:
  Train Loss: 0.2848, Train Acc: 0.9204
  Test Loss: 0.2888, Test Acc: 0.9147
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 29 [0/469] Loss: 0.2332 Acc: 0.9531 Iters: 50/50
Epoch 29 [100/469] Loss: 0.3221 Acc: 0.9219 Iters: 50/50
Epoch 29 [200/469] Loss: 0.3248 Acc: 0.9141 Iters: 50/50
Epoch 29 [300/469] Loss: 0.1471 Acc: 0.9453 Iters: 50/50
Epoch 29 [400/469] Loss: 0.1892 Acc: 0.9297 Iters: 50/50

Epoch 29 Summary:
  Train Loss: 0.2730, Train Acc: 0.9220
  Test Loss: 0.2734, Test Acc: 0.9231
  Avg Iters: 50.0/50.0
  Time: 64.9s

======================================================================
Training complete! Best test accuracy: 0.9231
======================================================================
