======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.22, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 3.1023 Acc: 0.2031 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2399 Acc: 0.2266 Iters: 50/50
Epoch 0 [200/469] Loss: 2.1452 Acc: 0.3281 Iters: 50/50
Epoch 0 [300/469] Loss: 2.1485 Acc: 0.1953 Iters: 50/50
Epoch 0 [400/469] Loss: 1.8001 Acc: 0.3750 Iters: 50/50
W1229 05:34:55.759000 698887 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1229 05:34:55.759000 698887 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1229 05:34:55.759000 698887 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1229 05:34:55.759000 698887 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1229 05:34:55.759000 698887 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.1158, Train Acc: 0.2652
  Test Loss: 1.7620, Test Acc: 0.3324
  Avg Iters: 50.0/50.0
  Time: 67.0s
Epoch 1 [0/469] Loss: 1.7847 Acc: 0.4375 Iters: 50/50
Epoch 1 [100/469] Loss: 1.4771 Acc: 0.5156 Iters: 50/50
Epoch 1 [200/469] Loss: 1.3235 Acc: 0.4922 Iters: 50/50
Epoch 1 [300/469] Loss: 1.0570 Acc: 0.6719 Iters: 50/50
Epoch 1 [400/469] Loss: 1.0805 Acc: 0.6484 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.2738, Train Acc: 0.5578
  Test Loss: 0.8901, Test Acc: 0.7088
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 2 [0/469] Loss: 0.8373 Acc: 0.6719 Iters: 50/50
Epoch 2 [100/469] Loss: 0.8347 Acc: 0.7031 Iters: 50/50
Epoch 2 [200/469] Loss: 0.5161 Acc: 0.8672 Iters: 50/50
Epoch 2 [300/469] Loss: 0.6854 Acc: 0.7969 Iters: 50/50
Epoch 2 [400/469] Loss: 0.7711 Acc: 0.7734 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.7064, Train Acc: 0.7803
  Test Loss: 0.6057, Test Acc: 0.8126
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 3 [0/469] Loss: 0.7252 Acc: 0.7578 Iters: 50/50
Epoch 3 [100/469] Loss: 0.5177 Acc: 0.8359 Iters: 50/50
Epoch 3 [200/469] Loss: 0.5515 Acc: 0.8828 Iters: 50/50
Epoch 3 [300/469] Loss: 0.6020 Acc: 0.8359 Iters: 50/50
Epoch 3 [400/469] Loss: 0.6317 Acc: 0.8359 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.5385, Train Acc: 0.8420
  Test Loss: 0.4800, Test Acc: 0.8605
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 4 [0/469] Loss: 0.4934 Acc: 0.8516 Iters: 50/50
Epoch 4 [100/469] Loss: 0.4697 Acc: 0.8594 Iters: 50/50
Epoch 4 [200/469] Loss: 0.2891 Acc: 0.9297 Iters: 50/50
Epoch 4 [300/469] Loss: 0.4249 Acc: 0.8672 Iters: 50/50
Epoch 4 [400/469] Loss: 0.5677 Acc: 0.8594 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4463, Train Acc: 0.8728
  Test Loss: 0.4038, Test Acc: 0.8845
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 5 [0/469] Loss: 0.3153 Acc: 0.9062 Iters: 50/50
Epoch 5 [100/469] Loss: 0.4505 Acc: 0.8828 Iters: 50/50
Epoch 5 [200/469] Loss: 0.3296 Acc: 0.9141 Iters: 50/50
Epoch 5 [300/469] Loss: 0.4536 Acc: 0.8984 Iters: 50/50
Epoch 5 [400/469] Loss: 0.4410 Acc: 0.8750 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3927, Train Acc: 0.8873
  Test Loss: 0.3676, Test Acc: 0.8923
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 6 [0/469] Loss: 0.2867 Acc: 0.9062 Iters: 50/50
Epoch 6 [100/469] Loss: 0.2793 Acc: 0.8906 Iters: 50/50
Epoch 6 [200/469] Loss: 0.2795 Acc: 0.8984 Iters: 50/50
Epoch 6 [300/469] Loss: 0.3155 Acc: 0.9297 Iters: 50/50
Epoch 6 [400/469] Loss: 0.2747 Acc: 0.9141 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3567, Train Acc: 0.8968
  Test Loss: 0.3287, Test Acc: 0.9042
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 7 [0/469] Loss: 0.3993 Acc: 0.8672 Iters: 50/50
Epoch 7 [100/469] Loss: 0.3502 Acc: 0.8906 Iters: 50/50
Epoch 7 [200/469] Loss: 0.3586 Acc: 0.9141 Iters: 50/50
Epoch 7 [300/469] Loss: 0.2213 Acc: 0.9375 Iters: 50/50
Epoch 7 [400/469] Loss: 0.5361 Acc: 0.8594 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3293, Train Acc: 0.9060
  Test Loss: 0.3009, Test Acc: 0.9140
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 8 [0/469] Loss: 0.2167 Acc: 0.9531 Iters: 50/50
Epoch 8 [100/469] Loss: 0.3588 Acc: 0.9297 Iters: 50/50
Epoch 8 [200/469] Loss: 0.3165 Acc: 0.8984 Iters: 50/50
Epoch 8 [300/469] Loss: 0.1634 Acc: 0.9453 Iters: 50/50
Epoch 8 [400/469] Loss: 0.4133 Acc: 0.8906 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3167, Train Acc: 0.9098
  Test Loss: 0.2992, Test Acc: 0.9113
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 9 [0/469] Loss: 0.1823 Acc: 0.9375 Iters: 50/50
Epoch 9 [100/469] Loss: 0.4982 Acc: 0.8516 Iters: 50/50
Epoch 9 [200/469] Loss: 0.5853 Acc: 0.8203 Iters: 50/50
Epoch 9 [300/469] Loss: 0.3498 Acc: 0.9297 Iters: 50/50
Epoch 9 [400/469] Loss: 0.3580 Acc: 0.8906 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3335, Train Acc: 0.9062
  Test Loss: 0.3035, Test Acc: 0.9153
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 10 [0/469] Loss: 0.3922 Acc: 0.9141 Iters: 50/50
Epoch 10 [100/469] Loss: 0.2167 Acc: 0.9375 Iters: 50/50
Epoch 10 [200/469] Loss: 0.4769 Acc: 0.8438 Iters: 50/50
Epoch 10 [300/469] Loss: 0.2556 Acc: 0.9062 Iters: 50/50
Epoch 10 [400/469] Loss: 0.3249 Acc: 0.8984 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.2996, Train Acc: 0.9159
  Test Loss: 0.2930, Test Acc: 0.9158
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 11 [0/469] Loss: 0.2797 Acc: 0.8906 Iters: 50/50
Epoch 11 [100/469] Loss: 0.1931 Acc: 0.9375 Iters: 50/50
Epoch 11 [200/469] Loss: 0.2469 Acc: 0.9062 Iters: 50/50
Epoch 11 [300/469] Loss: 0.2298 Acc: 0.9531 Iters: 50/50
Epoch 11 [400/469] Loss: 0.1887 Acc: 0.9531 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.2914, Train Acc: 0.9174
  Test Loss: 0.3215, Test Acc: 0.9092
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 12 [0/469] Loss: 0.2196 Acc: 0.9297 Iters: 50/50
Epoch 12 [100/469] Loss: 0.2572 Acc: 0.9297 Iters: 50/50
Epoch 12 [200/469] Loss: 0.2942 Acc: 0.9219 Iters: 50/50
Epoch 12 [300/469] Loss: 0.2776 Acc: 0.8984 Iters: 50/50
Epoch 12 [400/469] Loss: 0.1846 Acc: 0.9375 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.2872, Train Acc: 0.9186
  Test Loss: 0.2836, Test Acc: 0.9189
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 13 [0/469] Loss: 0.1825 Acc: 0.9609 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2232 Acc: 0.9141 Iters: 50/50
Epoch 13 [200/469] Loss: 0.2490 Acc: 0.9297 Iters: 50/50
Epoch 13 [300/469] Loss: 0.4057 Acc: 0.9219 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2096 Acc: 0.9219 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.3011, Train Acc: 0.9149
  Test Loss: 0.2822, Test Acc: 0.9186
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 14 [0/469] Loss: 0.2698 Acc: 0.9219 Iters: 50/50
Epoch 14 [100/469] Loss: 0.3596 Acc: 0.9375 Iters: 50/50
Epoch 14 [200/469] Loss: 0.2391 Acc: 0.9219 Iters: 50/50
Epoch 14 [300/469] Loss: 0.5152 Acc: 0.8672 Iters: 50/50
Epoch 14 [400/469] Loss: 0.8632 Acc: 0.7812 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.5858, Train Acc: 0.8526
  Test Loss: 1.8078, Test Acc: 0.3327
  Avg Iters: 50.0/50.0
  Time: 63.5s
Epoch 15 [0/469] Loss: 1.7721 Acc: 0.3359 Iters: 50/50
Epoch 15 [100/469] Loss: 1.6911 Acc: 0.5781 Iters: 50/50
Epoch 15 [200/469] Loss: 1.5002 Acc: 0.7188 Iters: 50/50
Epoch 15 [300/469] Loss: 1.0815 Acc: 0.7344 Iters: 50/50
Epoch 15 [400/469] Loss: 0.8443 Acc: 0.8594 Iters: 50/50

Epoch 15 Summary:
  Train Loss: 1.2562, Train Acc: 0.6708
  Test Loss: 0.7865, Test Acc: 0.8080
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 16 [0/469] Loss: 0.8263 Acc: 0.8359 Iters: 50/50
Epoch 16 [100/469] Loss: 0.7397 Acc: 0.8125 Iters: 50/50
Epoch 16 [200/469] Loss: 0.6028 Acc: 0.8359 Iters: 50/50
Epoch 16 [300/469] Loss: 0.6647 Acc: 0.8672 Iters: 50/50
Epoch 16 [400/469] Loss: 0.6237 Acc: 0.8281 Iters: 50/50

Epoch 16 Summary:
  Train Loss: 0.6335, Train Acc: 0.8395
  Test Loss: 0.4980, Test Acc: 0.8703
  Avg Iters: 50.0/50.0
  Time: 63.5s
Epoch 17 [0/469] Loss: 0.4929 Acc: 0.8828 Iters: 50/50
Epoch 17 [100/469] Loss: 0.5407 Acc: 0.8516 Iters: 50/50
Epoch 17 [200/469] Loss: 0.3438 Acc: 0.9297 Iters: 50/50
Epoch 17 [300/469] Loss: 0.4286 Acc: 0.8906 Iters: 50/50
Epoch 17 [400/469] Loss: 0.3752 Acc: 0.8984 Iters: 50/50

Epoch 17 Summary:
  Train Loss: 0.4502, Train Acc: 0.8790
  Test Loss: 0.4174, Test Acc: 0.8877
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 18 [0/469] Loss: 0.4745 Acc: 0.8438 Iters: 50/50
Epoch 18 [100/469] Loss: 0.3533 Acc: 0.8672 Iters: 50/50
Epoch 18 [200/469] Loss: 0.4331 Acc: 0.8750 Iters: 50/50
Epoch 18 [300/469] Loss: 0.4427 Acc: 0.9141 Iters: 50/50
Epoch 18 [400/469] Loss: 0.5029 Acc: 0.9219 Iters: 50/50

Epoch 18 Summary:
  Train Loss: 0.3903, Train Acc: 0.8957
  Test Loss: 0.3852, Test Acc: 0.8973
  Avg Iters: 50.0/50.0
  Time: 63.3s
Epoch 19 [0/469] Loss: 0.3620 Acc: 0.9141 Iters: 50/50
Epoch 19 [100/469] Loss: 0.3369 Acc: 0.9062 Iters: 50/50
Epoch 19 [200/469] Loss: 0.3308 Acc: 0.9141 Iters: 50/50
Epoch 19 [300/469] Loss: 0.2258 Acc: 0.9219 Iters: 50/50
Epoch 19 [400/469] Loss: 0.3813 Acc: 0.8984 Iters: 50/50

Epoch 19 Summary:
  Train Loss: 0.3598, Train Acc: 0.9043
  Test Loss: 0.3503, Test Acc: 0.9083
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 20 [0/469] Loss: 0.2539 Acc: 0.9297 Iters: 50/50
Epoch 20 [100/469] Loss: 0.5132 Acc: 0.8906 Iters: 50/50
Epoch 20 [200/469] Loss: 0.3096 Acc: 0.9062 Iters: 50/50
Epoch 20 [300/469] Loss: 0.3799 Acc: 0.8828 Iters: 50/50
Epoch 20 [400/469] Loss: 0.3521 Acc: 0.9141 Iters: 50/50

Epoch 20 Summary:
  Train Loss: 0.3554, Train Acc: 0.9058
  Test Loss: 0.3446, Test Acc: 0.9090
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 21 [0/469] Loss: 0.2529 Acc: 0.9141 Iters: 50/50
Epoch 21 [100/469] Loss: 0.3573 Acc: 0.8906 Iters: 50/50
Epoch 21 [200/469] Loss: 0.2774 Acc: 0.9297 Iters: 50/50
Epoch 21 [300/469] Loss: 0.3753 Acc: 0.9141 Iters: 50/50
Epoch 21 [400/469] Loss: 0.6291 Acc: 0.8750 Iters: 50/50

Epoch 21 Summary:
  Train Loss: 0.3909, Train Acc: 0.9006
  Test Loss: 0.4668, Test Acc: 0.8708
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 22 [0/469] Loss: 0.5060 Acc: 0.8828 Iters: 50/50
Epoch 22 [100/469] Loss: 0.2164 Acc: 0.9141 Iters: 50/50
Epoch 22 [200/469] Loss: 0.2354 Acc: 0.9375 Iters: 50/50
Epoch 22 [300/469] Loss: 0.5590 Acc: 0.8516 Iters: 50/50
Epoch 22 [400/469] Loss: 0.2861 Acc: 0.9219 Iters: 50/50

Epoch 22 Summary:
  Train Loss: 0.3716, Train Acc: 0.9010
  Test Loss: 0.3553, Test Acc: 0.9018
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 23 [0/469] Loss: 0.2851 Acc: 0.9141 Iters: 50/50
Epoch 23 [100/469] Loss: 0.2896 Acc: 0.8984 Iters: 50/50
Epoch 23 [200/469] Loss: 0.2420 Acc: 0.9219 Iters: 50/50
Epoch 23 [300/469] Loss: 0.4978 Acc: 0.8828 Iters: 50/50
Epoch 23 [400/469] Loss: 0.3307 Acc: 0.9297 Iters: 50/50

Epoch 23 Summary:
  Train Loss: 0.3319, Train Acc: 0.9092
  Test Loss: 0.3432, Test Acc: 0.9006
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 24 [0/469] Loss: 0.3393 Acc: 0.8906 Iters: 50/50
Epoch 24 [100/469] Loss: 0.2267 Acc: 0.9141 Iters: 50/50
Epoch 24 [200/469] Loss: 0.3097 Acc: 0.9453 Iters: 50/50
Epoch 24 [300/469] Loss: 0.3880 Acc: 0.9219 Iters: 50/50
Epoch 24 [400/469] Loss: 0.3480 Acc: 0.9062 Iters: 50/50

Epoch 24 Summary:
  Train Loss: 0.3178, Train Acc: 0.9132
  Test Loss: 0.3111, Test Acc: 0.9164
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 25 [0/469] Loss: 0.5689 Acc: 0.8984 Iters: 50/50
Epoch 25 [100/469] Loss: 0.2738 Acc: 0.9375 Iters: 50/50
Epoch 25 [200/469] Loss: 0.3232 Acc: 0.9219 Iters: 50/50
Epoch 25 [300/469] Loss: 0.1712 Acc: 0.9609 Iters: 50/50
Epoch 25 [400/469] Loss: 0.4262 Acc: 0.8750 Iters: 50/50

Epoch 25 Summary:
  Train Loss: 0.3119, Train Acc: 0.9147
  Test Loss: 0.3397, Test Acc: 0.9040
  Avg Iters: 50.0/50.0
  Time: 64.7s
Epoch 26 [0/469] Loss: 0.4997 Acc: 0.9062 Iters: 50/50
Epoch 26 [100/469] Loss: 0.2980 Acc: 0.9062 Iters: 50/50
Epoch 26 [200/469] Loss: 0.2760 Acc: 0.9375 Iters: 50/50
Epoch 26 [300/469] Loss: 0.2609 Acc: 0.9297 Iters: 50/50
Epoch 26 [400/469] Loss: 0.2609 Acc: 0.9219 Iters: 50/50

Epoch 26 Summary:
  Train Loss: 0.3049, Train Acc: 0.9158
  Test Loss: 0.3008, Test Acc: 0.9191
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 27 [0/469] Loss: 0.3623 Acc: 0.9062 Iters: 50/50
Epoch 27 [100/469] Loss: 0.1878 Acc: 0.9375 Iters: 50/50
Epoch 27 [200/469] Loss: 0.3739 Acc: 0.9453 Iters: 50/50
Epoch 27 [300/469] Loss: 0.3111 Acc: 0.9297 Iters: 50/50
Epoch 27 [400/469] Loss: 0.2437 Acc: 0.9219 Iters: 50/50

Epoch 27 Summary:
  Train Loss: 0.2988, Train Acc: 0.9168
  Test Loss: 0.2995, Test Acc: 0.9161
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 28 [0/469] Loss: 0.2287 Acc: 0.8984 Iters: 50/50
Epoch 28 [100/469] Loss: 0.1160 Acc: 0.9609 Iters: 50/50
Epoch 28 [200/469] Loss: 0.3403 Acc: 0.9453 Iters: 50/50
Epoch 28 [300/469] Loss: 0.1268 Acc: 0.9844 Iters: 50/50
Epoch 28 [400/469] Loss: 0.2902 Acc: 0.9062 Iters: 50/50

Epoch 28 Summary:
  Train Loss: 0.2924, Train Acc: 0.9188
  Test Loss: 0.3092, Test Acc: 0.9100
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 29 [0/469] Loss: 0.3141 Acc: 0.8750 Iters: 50/50
Epoch 29 [100/469] Loss: 0.2032 Acc: 0.9375 Iters: 50/50
Epoch 29 [200/469] Loss: 0.2482 Acc: 0.9531 Iters: 50/50
Epoch 29 [300/469] Loss: 0.2538 Acc: 0.9297 Iters: 50/50
Epoch 29 [400/469] Loss: 0.1737 Acc: 0.9297 Iters: 50/50

Epoch 29 Summary:
  Train Loss: 0.2857, Train Acc: 0.9188
  Test Loss: 0.2818, Test Acc: 0.9197
  Avg Iters: 50.0/50.0
  Time: 64.3s

======================================================================
Training complete! Best test accuracy: 0.9197
======================================================================
