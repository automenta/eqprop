======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.26, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 2.8362 Acc: 0.1250 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2804 Acc: 0.1094 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2793 Acc: 0.1875 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2001 Acc: 0.1562 Iters: 50/50
Epoch 0 [400/469] Loss: 1.9310 Acc: 0.3750 Iters: 50/50
W1229 00:58:39.151000 664066 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1229 00:58:39.151000 664066 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1229 00:58:39.151000 664066 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1229 00:58:39.151000 664066 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1229 00:58:39.151000 664066 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.1551, Train Acc: 0.2408
  Test Loss: 1.5788, Test Acc: 0.4736
  Avg Iters: 50.0/50.0
  Time: 66.7s
Epoch 1 [0/469] Loss: 1.6217 Acc: 0.4297 Iters: 50/50
Epoch 1 [100/469] Loss: 1.2664 Acc: 0.5391 Iters: 50/50
Epoch 1 [200/469] Loss: 0.9289 Acc: 0.6641 Iters: 50/50
Epoch 1 [300/469] Loss: 0.7797 Acc: 0.7344 Iters: 50/50
Epoch 1 [400/469] Loss: 0.7491 Acc: 0.7188 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 0.9841, Train Acc: 0.6675
  Test Loss: 0.7134, Test Acc: 0.7754
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 2 [0/469] Loss: 0.4844 Acc: 0.8359 Iters: 50/50
Epoch 2 [100/469] Loss: 0.7022 Acc: 0.7578 Iters: 50/50
Epoch 2 [200/469] Loss: 0.5522 Acc: 0.8281 Iters: 50/50
Epoch 2 [300/469] Loss: 0.6169 Acc: 0.8047 Iters: 50/50
Epoch 2 [400/469] Loss: 0.6817 Acc: 0.8281 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.6308, Train Acc: 0.8090
  Test Loss: 0.5466, Test Acc: 0.8390
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 3 [0/469] Loss: 0.4395 Acc: 0.8516 Iters: 50/50
Epoch 3 [100/469] Loss: 0.5564 Acc: 0.8516 Iters: 50/50
Epoch 3 [200/469] Loss: 0.6419 Acc: 0.8438 Iters: 50/50
Epoch 3 [300/469] Loss: 0.5603 Acc: 0.8438 Iters: 50/50
Epoch 3 [400/469] Loss: 0.5850 Acc: 0.8672 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.4963, Train Acc: 0.8555
  Test Loss: 0.4209, Test Acc: 0.8789
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 4 [0/469] Loss: 0.4358 Acc: 0.8516 Iters: 50/50
Epoch 4 [100/469] Loss: 0.3647 Acc: 0.8828 Iters: 50/50
Epoch 4 [200/469] Loss: 0.3206 Acc: 0.9141 Iters: 50/50
Epoch 4 [300/469] Loss: 0.3817 Acc: 0.8984 Iters: 50/50
Epoch 4 [400/469] Loss: 0.3653 Acc: 0.8594 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4093, Train Acc: 0.8829
  Test Loss: 0.3634, Test Acc: 0.8986
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 5 [0/469] Loss: 0.4593 Acc: 0.8750 Iters: 50/50
Epoch 5 [100/469] Loss: 0.5446 Acc: 0.8828 Iters: 50/50
Epoch 5 [200/469] Loss: 0.3527 Acc: 0.9141 Iters: 50/50
Epoch 5 [300/469] Loss: 0.4269 Acc: 0.9062 Iters: 50/50
Epoch 5 [400/469] Loss: 0.3040 Acc: 0.9141 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3739, Train Acc: 0.8941
  Test Loss: 0.3394, Test Acc: 0.9040
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 6 [0/469] Loss: 0.2764 Acc: 0.9219 Iters: 50/50
Epoch 6 [100/469] Loss: 0.2785 Acc: 0.9219 Iters: 50/50
Epoch 6 [200/469] Loss: 0.2710 Acc: 0.8984 Iters: 50/50
Epoch 6 [300/469] Loss: 0.3707 Acc: 0.8906 Iters: 50/50
Epoch 6 [400/469] Loss: 0.3166 Acc: 0.9219 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3305, Train Acc: 0.9053
  Test Loss: 0.3292, Test Acc: 0.9031
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 7 [0/469] Loss: 0.3474 Acc: 0.8828 Iters: 50/50
Epoch 7 [100/469] Loss: 0.2783 Acc: 0.9297 Iters: 50/50
Epoch 7 [200/469] Loss: 0.1721 Acc: 0.9219 Iters: 50/50
Epoch 7 [300/469] Loss: 0.2404 Acc: 0.9219 Iters: 50/50
Epoch 7 [400/469] Loss: 0.3063 Acc: 0.9297 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3139, Train Acc: 0.9103
  Test Loss: 0.2934, Test Acc: 0.9129
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 8 [0/469] Loss: 0.2714 Acc: 0.9219 Iters: 50/50
Epoch 8 [100/469] Loss: 0.4185 Acc: 0.8828 Iters: 50/50
Epoch 8 [200/469] Loss: 0.2411 Acc: 0.9219 Iters: 50/50
Epoch 8 [300/469] Loss: 0.1597 Acc: 0.9531 Iters: 50/50
Epoch 8 [400/469] Loss: 0.3760 Acc: 0.8906 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3009, Train Acc: 0.9138
  Test Loss: 0.2914, Test Acc: 0.9160
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 9 [0/469] Loss: 0.1883 Acc: 0.9297 Iters: 50/50
Epoch 9 [100/469] Loss: 0.2854 Acc: 0.9219 Iters: 50/50
Epoch 9 [200/469] Loss: 0.2435 Acc: 0.9375 Iters: 50/50
Epoch 9 [300/469] Loss: 0.3418 Acc: 0.8984 Iters: 50/50
Epoch 9 [400/469] Loss: 0.1566 Acc: 0.9375 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.2909, Train Acc: 0.9167
  Test Loss: 0.2839, Test Acc: 0.9164
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 10 [0/469] Loss: 0.3465 Acc: 0.9062 Iters: 50/50
Epoch 10 [100/469] Loss: 0.2423 Acc: 0.9141 Iters: 50/50
Epoch 10 [200/469] Loss: 0.4008 Acc: 0.9219 Iters: 50/50
Epoch 10 [300/469] Loss: 0.2605 Acc: 0.8906 Iters: 50/50
Epoch 10 [400/469] Loss: 0.8856 Acc: 0.7734 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.4565, Train Acc: 0.8721
  Test Loss: 0.7498, Test Acc: 0.7937
  Avg Iters: 50.0/50.0
  Time: 63.1s
Epoch 11 [0/469] Loss: 0.8339 Acc: 0.7969 Iters: 50/50
Epoch 11 [100/469] Loss: 0.4496 Acc: 0.8828 Iters: 50/50
Epoch 11 [200/469] Loss: 0.3787 Acc: 0.9062 Iters: 50/50
Epoch 11 [300/469] Loss: 0.2762 Acc: 0.8828 Iters: 50/50
Epoch 11 [400/469] Loss: 0.2817 Acc: 0.9062 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.4507, Train Acc: 0.8756
  Test Loss: 0.3529, Test Acc: 0.9014
  Avg Iters: 50.0/50.0
  Time: 62.6s
Epoch 12 [0/469] Loss: 0.3431 Acc: 0.8750 Iters: 50/50
Epoch 12 [100/469] Loss: 0.5241 Acc: 0.8672 Iters: 50/50
Epoch 12 [200/469] Loss: 0.4958 Acc: 0.8594 Iters: 50/50
Epoch 12 [300/469] Loss: 0.2958 Acc: 0.9219 Iters: 50/50
Epoch 12 [400/469] Loss: 0.3059 Acc: 0.9219 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.3281, Train Acc: 0.9076
  Test Loss: 0.3094, Test Acc: 0.9151
  Avg Iters: 50.0/50.0
  Time: 63.0s
Epoch 13 [0/469] Loss: 0.4385 Acc: 0.8594 Iters: 50/50
Epoch 13 [100/469] Loss: 0.3442 Acc: 0.9219 Iters: 50/50
Epoch 13 [200/469] Loss: 0.1817 Acc: 0.9297 Iters: 50/50
Epoch 13 [300/469] Loss: 0.2944 Acc: 0.9453 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2294 Acc: 0.9531 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.3044, Train Acc: 0.9148
  Test Loss: 0.3215, Test Acc: 0.9029
  Avg Iters: 50.0/50.0
  Time: 63.0s
Epoch 14 [0/469] Loss: 0.4379 Acc: 0.8672 Iters: 50/50
Epoch 14 [100/469] Loss: 0.3017 Acc: 0.9375 Iters: 50/50
Epoch 14 [200/469] Loss: 0.2947 Acc: 0.8984 Iters: 50/50
Epoch 14 [300/469] Loss: 0.2326 Acc: 0.9219 Iters: 50/50
Epoch 14 [400/469] Loss: 0.3095 Acc: 0.9141 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.2966, Train Acc: 0.9155
  Test Loss: 0.3214, Test Acc: 0.9067
  Avg Iters: 50.0/50.0
  Time: 64.9s

======================================================================
Training complete! Best test accuracy: 0.9164
======================================================================
