======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.23, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 3.0340 Acc: 0.2109 Iters: 50/50
Epoch 0 [100/469] Loss: 2.3048 Acc: 0.0703 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2718 Acc: 0.1016 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2088 Acc: 0.2266 Iters: 50/50
Epoch 0 [400/469] Loss: 2.1459 Acc: 0.2734 Iters: 50/50
W1229 00:08:33.487000 661454 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1229 00:08:33.487000 661454 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1229 00:08:33.487000 661454 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1229 00:08:33.487000 661454 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1229 00:08:33.487000 661454 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.2313, Train Acc: 0.2036
  Test Loss: 1.9883, Test Acc: 0.3024
  Avg Iters: 50.0/50.0
  Time: 66.3s
Epoch 1 [0/469] Loss: 1.9849 Acc: 0.2812 Iters: 50/50
Epoch 1 [100/469] Loss: 1.5119 Acc: 0.3984 Iters: 50/50
Epoch 1 [200/469] Loss: 1.3769 Acc: 0.4766 Iters: 50/50
Epoch 1 [300/469] Loss: 1.1550 Acc: 0.6797 Iters: 50/50
Epoch 1 [400/469] Loss: 1.0007 Acc: 0.6641 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.2995, Train Acc: 0.5459
  Test Loss: 0.9155, Test Acc: 0.7081
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 2 [0/469] Loss: 0.9607 Acc: 0.6562 Iters: 50/50
Epoch 2 [100/469] Loss: 0.9293 Acc: 0.6953 Iters: 50/50
Epoch 2 [200/469] Loss: 0.6532 Acc: 0.7891 Iters: 50/50
Epoch 2 [300/469] Loss: 0.6218 Acc: 0.8125 Iters: 50/50
Epoch 2 [400/469] Loss: 0.7452 Acc: 0.7969 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.7189, Train Acc: 0.7726
  Test Loss: 0.5861, Test Acc: 0.8210
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 3 [0/469] Loss: 0.6065 Acc: 0.7969 Iters: 50/50
Epoch 3 [100/469] Loss: 0.5696 Acc: 0.8516 Iters: 50/50
Epoch 3 [200/469] Loss: 0.4329 Acc: 0.8516 Iters: 50/50
Epoch 3 [300/469] Loss: 0.4767 Acc: 0.8438 Iters: 50/50
Epoch 3 [400/469] Loss: 0.4345 Acc: 0.8906 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.5096, Train Acc: 0.8485
  Test Loss: 0.4404, Test Acc: 0.8721
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 4 [0/469] Loss: 0.5993 Acc: 0.8047 Iters: 50/50
Epoch 4 [100/469] Loss: 0.5501 Acc: 0.8516 Iters: 50/50
Epoch 4 [200/469] Loss: 0.3312 Acc: 0.8828 Iters: 50/50
Epoch 4 [300/469] Loss: 0.3967 Acc: 0.9062 Iters: 50/50
Epoch 4 [400/469] Loss: 0.5069 Acc: 0.8828 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4298, Train Acc: 0.8771
  Test Loss: 0.3879, Test Acc: 0.8927
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 5 [0/469] Loss: 0.4678 Acc: 0.8281 Iters: 50/50
Epoch 5 [100/469] Loss: 0.3572 Acc: 0.8906 Iters: 50/50
Epoch 5 [200/469] Loss: 0.4175 Acc: 0.9062 Iters: 50/50
Epoch 5 [300/469] Loss: 0.3229 Acc: 0.9219 Iters: 50/50
Epoch 5 [400/469] Loss: 0.3362 Acc: 0.8984 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3834, Train Acc: 0.8897
  Test Loss: 0.3789, Test Acc: 0.8904
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 6 [0/469] Loss: 0.4066 Acc: 0.8594 Iters: 50/50
Epoch 6 [100/469] Loss: 0.3787 Acc: 0.8672 Iters: 50/50
Epoch 6 [200/469] Loss: 0.2644 Acc: 0.9453 Iters: 50/50
Epoch 6 [300/469] Loss: 0.3291 Acc: 0.9141 Iters: 50/50
Epoch 6 [400/469] Loss: 0.3880 Acc: 0.9062 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3613, Train Acc: 0.8960
  Test Loss: 0.3511, Test Acc: 0.9015
  Avg Iters: 50.0/50.0
  Time: 62.8s
Epoch 7 [0/469] Loss: 0.3367 Acc: 0.8906 Iters: 50/50
Epoch 7 [100/469] Loss: 0.2075 Acc: 0.9297 Iters: 50/50
Epoch 7 [200/469] Loss: 0.2481 Acc: 0.9141 Iters: 50/50
Epoch 7 [300/469] Loss: 0.3025 Acc: 0.9219 Iters: 50/50
Epoch 7 [400/469] Loss: 0.3766 Acc: 0.9141 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3446, Train Acc: 0.9019
  Test Loss: 0.3346, Test Acc: 0.9027
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 8 [0/469] Loss: 0.3619 Acc: 0.8672 Iters: 50/50
Epoch 8 [100/469] Loss: 0.2414 Acc: 0.9297 Iters: 50/50
Epoch 8 [200/469] Loss: 0.4816 Acc: 0.8672 Iters: 50/50
Epoch 8 [300/469] Loss: 0.3062 Acc: 0.9141 Iters: 50/50
Epoch 8 [400/469] Loss: 0.3911 Acc: 0.8984 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3321, Train Acc: 0.9052
  Test Loss: 0.3138, Test Acc: 0.9087
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 9 [0/469] Loss: 0.2312 Acc: 0.9531 Iters: 50/50
Epoch 9 [100/469] Loss: 0.3162 Acc: 0.8984 Iters: 50/50
Epoch 9 [200/469] Loss: 0.3339 Acc: 0.8984 Iters: 50/50
Epoch 9 [300/469] Loss: 0.3358 Acc: 0.9141 Iters: 50/50
Epoch 9 [400/469] Loss: 0.4426 Acc: 0.8906 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3051, Train Acc: 0.9129
  Test Loss: 0.2847, Test Acc: 0.9198
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 10 [0/469] Loss: 0.3139 Acc: 0.9062 Iters: 50/50
Epoch 10 [100/469] Loss: 0.2708 Acc: 0.8906 Iters: 50/50
Epoch 10 [200/469] Loss: 0.3511 Acc: 0.8906 Iters: 50/50
Epoch 10 [300/469] Loss: 0.3235 Acc: 0.9219 Iters: 50/50
Epoch 10 [400/469] Loss: 0.3379 Acc: 0.8984 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.2973, Train Acc: 0.9147
  Test Loss: 0.2840, Test Acc: 0.9181
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 11 [0/469] Loss: 0.2462 Acc: 0.9375 Iters: 50/50
Epoch 11 [100/469] Loss: 0.4039 Acc: 0.8984 Iters: 50/50
Epoch 11 [200/469] Loss: 0.1852 Acc: 0.9609 Iters: 50/50
Epoch 11 [300/469] Loss: 0.2949 Acc: 0.9141 Iters: 50/50
Epoch 11 [400/469] Loss: 0.4201 Acc: 0.8672 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.2889, Train Acc: 0.9161
  Test Loss: 0.2922, Test Acc: 0.9130
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 12 [0/469] Loss: 0.2703 Acc: 0.8984 Iters: 50/50
Epoch 12 [100/469] Loss: 0.7060 Acc: 0.7578 Iters: 50/50
Epoch 12 [200/469] Loss: 0.3578 Acc: 0.8906 Iters: 50/50
Epoch 12 [300/469] Loss: 0.3745 Acc: 0.8828 Iters: 50/50
Epoch 12 [400/469] Loss: 0.2852 Acc: 0.9219 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.4411, Train Acc: 0.8768
  Test Loss: 0.3122, Test Acc: 0.9124
  Avg Iters: 50.0/50.0
  Time: 63.5s
Epoch 13 [0/469] Loss: 0.2656 Acc: 0.9141 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2288 Acc: 0.9297 Iters: 50/50
Epoch 13 [200/469] Loss: 0.2916 Acc: 0.9062 Iters: 50/50
Epoch 13 [300/469] Loss: 0.2319 Acc: 0.9141 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2207 Acc: 0.9219 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.3045, Train Acc: 0.9143
  Test Loss: 0.2950, Test Acc: 0.9180
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 14 [0/469] Loss: 0.2991 Acc: 0.9219 Iters: 50/50
Epoch 14 [100/469] Loss: 0.3244 Acc: 0.8984 Iters: 50/50
Epoch 14 [200/469] Loss: 0.2635 Acc: 0.9453 Iters: 50/50
Epoch 14 [300/469] Loss: 0.3838 Acc: 0.8984 Iters: 50/50
Epoch 14 [400/469] Loss: 0.3884 Acc: 0.8828 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.2950, Train Acc: 0.9164
  Test Loss: 0.3072, Test Acc: 0.9092
  Avg Iters: 50.0/50.0
  Time: 63.8s

======================================================================
Training complete! Best test accuracy: 0.9198
======================================================================
