======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.21, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 2.8098 Acc: 0.1094 Iters: 50/50
Epoch 0 [100/469] Loss: 2.3010 Acc: 0.1016 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2591 Acc: 0.2578 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2648 Acc: 0.1719 Iters: 50/50
Epoch 0 [400/469] Loss: 2.2464 Acc: 0.1562 Iters: 50/50
W1228 23:35:04.329000 659763 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1228 23:35:04.329000 659763 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1228 23:35:04.329000 659763 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1228 23:35:04.329000 659763 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1228 23:35:04.329000 659763 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.2771, Train Acc: 0.1737
  Test Loss: 2.1800, Test Acc: 0.3418
  Avg Iters: 50.0/50.0
  Time: 66.3s
Epoch 1 [0/469] Loss: 2.1688 Acc: 0.3125 Iters: 50/50
Epoch 1 [100/469] Loss: 1.9533 Acc: 0.4453 Iters: 50/50
Epoch 1 [200/469] Loss: 1.7233 Acc: 0.3984 Iters: 50/50
Epoch 1 [300/469] Loss: 1.4712 Acc: 0.4844 Iters: 50/50
Epoch 1 [400/469] Loss: 1.1224 Acc: 0.5938 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.6367, Train Acc: 0.4210
  Test Loss: 1.1453, Test Acc: 0.6230
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 2 [0/469] Loss: 1.0542 Acc: 0.6562 Iters: 50/50
Epoch 2 [100/469] Loss: 0.9937 Acc: 0.6797 Iters: 50/50
Epoch 2 [200/469] Loss: 0.9133 Acc: 0.6875 Iters: 50/50
Epoch 2 [300/469] Loss: 0.8953 Acc: 0.7031 Iters: 50/50
Epoch 2 [400/469] Loss: 0.8152 Acc: 0.7266 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.8916, Train Acc: 0.7019
  Test Loss: 0.6668, Test Acc: 0.7926
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 3 [0/469] Loss: 0.6586 Acc: 0.8359 Iters: 50/50
Epoch 3 [100/469] Loss: 0.4898 Acc: 0.8516 Iters: 50/50
Epoch 3 [200/469] Loss: 0.6299 Acc: 0.8281 Iters: 50/50
Epoch 3 [300/469] Loss: 0.4581 Acc: 0.8594 Iters: 50/50
Epoch 3 [400/469] Loss: 0.5795 Acc: 0.8359 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.6095, Train Acc: 0.8156
  Test Loss: 0.5367, Test Acc: 0.8427
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 4 [0/469] Loss: 0.4735 Acc: 0.8438 Iters: 50/50
Epoch 4 [100/469] Loss: 0.5313 Acc: 0.8672 Iters: 50/50
Epoch 4 [200/469] Loss: 0.5122 Acc: 0.8672 Iters: 50/50
Epoch 4 [300/469] Loss: 0.8094 Acc: 0.7812 Iters: 50/50
Epoch 4 [400/469] Loss: 0.4961 Acc: 0.8516 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.5363, Train Acc: 0.8477
  Test Loss: 0.4529, Test Acc: 0.8698
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 5 [0/469] Loss: 0.3895 Acc: 0.8750 Iters: 50/50
Epoch 5 [100/469] Loss: 0.6297 Acc: 0.8438 Iters: 50/50
Epoch 5 [200/469] Loss: 0.4732 Acc: 0.8750 Iters: 50/50
Epoch 5 [300/469] Loss: 0.4459 Acc: 0.8750 Iters: 50/50
Epoch 5 [400/469] Loss: 0.2474 Acc: 0.9375 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.4231, Train Acc: 0.8791
  Test Loss: 0.3992, Test Acc: 0.8823
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 6 [0/469] Loss: 0.4107 Acc: 0.8750 Iters: 50/50
Epoch 6 [100/469] Loss: 0.3492 Acc: 0.9375 Iters: 50/50
Epoch 6 [200/469] Loss: 0.3785 Acc: 0.9141 Iters: 50/50
Epoch 6 [300/469] Loss: 0.4993 Acc: 0.8594 Iters: 50/50
Epoch 6 [400/469] Loss: 0.4788 Acc: 0.8984 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3757, Train Acc: 0.8941
  Test Loss: 0.3490, Test Acc: 0.9002
  Avg Iters: 50.0/50.0
  Time: 63.4s
Epoch 7 [0/469] Loss: 0.2698 Acc: 0.9062 Iters: 50/50
Epoch 7 [100/469] Loss: 0.3385 Acc: 0.9062 Iters: 50/50
Epoch 7 [200/469] Loss: 0.3714 Acc: 0.9062 Iters: 50/50
Epoch 7 [300/469] Loss: 0.4105 Acc: 0.8750 Iters: 50/50
Epoch 7 [400/469] Loss: 0.4436 Acc: 0.9062 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3414, Train Acc: 0.9030
  Test Loss: 0.3163, Test Acc: 0.9099
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 8 [0/469] Loss: 0.4040 Acc: 0.8672 Iters: 50/50
Epoch 8 [100/469] Loss: 0.2924 Acc: 0.8906 Iters: 50/50
Epoch 8 [200/469] Loss: 0.2264 Acc: 0.9375 Iters: 50/50
Epoch 8 [300/469] Loss: 0.3791 Acc: 0.8984 Iters: 50/50
Epoch 8 [400/469] Loss: 0.2435 Acc: 0.9375 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3206, Train Acc: 0.9077
  Test Loss: 0.2967, Test Acc: 0.9148
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 9 [0/469] Loss: 0.2790 Acc: 0.9062 Iters: 50/50
Epoch 9 [100/469] Loss: 0.3239 Acc: 0.8984 Iters: 50/50
Epoch 9 [200/469] Loss: 0.3376 Acc: 0.9219 Iters: 50/50
Epoch 9 [300/469] Loss: 0.4025 Acc: 0.9297 Iters: 50/50
Epoch 9 [400/469] Loss: 0.2536 Acc: 0.9219 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3063, Train Acc: 0.9123
  Test Loss: 0.3210, Test Acc: 0.9083
  Avg Iters: 50.0/50.0
  Time: 63.7s
Epoch 10 [0/469] Loss: 0.3179 Acc: 0.9062 Iters: 50/50
Epoch 10 [100/469] Loss: 0.4487 Acc: 0.9141 Iters: 50/50
Epoch 10 [200/469] Loss: 0.5086 Acc: 0.9141 Iters: 50/50
Epoch 10 [300/469] Loss: 0.3049 Acc: 0.8906 Iters: 50/50
Epoch 10 [400/469] Loss: 0.5783 Acc: 0.8594 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.4292, Train Acc: 0.8840
  Test Loss: 0.5276, Test Acc: 0.8432
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 11 [0/469] Loss: 0.5196 Acc: 0.8438 Iters: 50/50
Epoch 11 [100/469] Loss: 0.5575 Acc: 0.8828 Iters: 50/50
Epoch 11 [200/469] Loss: 0.3526 Acc: 0.8906 Iters: 50/50
Epoch 11 [300/469] Loss: 0.3326 Acc: 0.9062 Iters: 50/50
Epoch 11 [400/469] Loss: 0.3968 Acc: 0.9141 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.3927, Train Acc: 0.8917
  Test Loss: 0.3634, Test Acc: 0.8998
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 12 [0/469] Loss: 0.3719 Acc: 0.9062 Iters: 50/50
Epoch 12 [100/469] Loss: 0.2873 Acc: 0.9062 Iters: 50/50
Epoch 12 [200/469] Loss: 0.2142 Acc: 0.9297 Iters: 50/50
Epoch 12 [300/469] Loss: 0.3788 Acc: 0.8984 Iters: 50/50
Epoch 12 [400/469] Loss: 0.4510 Acc: 0.8984 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.3427, Train Acc: 0.9053
  Test Loss: 0.3307, Test Acc: 0.9069
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 13 [0/469] Loss: 0.3076 Acc: 0.9062 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2563 Acc: 0.9219 Iters: 50/50
Epoch 13 [200/469] Loss: 0.5656 Acc: 0.8594 Iters: 50/50
Epoch 13 [300/469] Loss: 0.2756 Acc: 0.9141 Iters: 50/50
Epoch 13 [400/469] Loss: 0.3412 Acc: 0.9219 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.3126, Train Acc: 0.9117
  Test Loss: 0.3043, Test Acc: 0.9117
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 14 [0/469] Loss: 0.2466 Acc: 0.9297 Iters: 50/50
Epoch 14 [100/469] Loss: 0.3651 Acc: 0.8828 Iters: 50/50
Epoch 14 [200/469] Loss: 0.3546 Acc: 0.8750 Iters: 50/50
Epoch 14 [300/469] Loss: 0.3316 Acc: 0.8828 Iters: 50/50
Epoch 14 [400/469] Loss: 0.3599 Acc: 0.8906 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.3075, Train Acc: 0.9127
  Test Loss: 0.3023, Test Acc: 0.9155
  Avg Iters: 50.0/50.0
  Time: 63.6s

======================================================================
Training complete! Best test accuracy: 0.9155
======================================================================
