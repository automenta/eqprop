======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.2, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 2.8161 Acc: 0.1250 Iters: 50/50
Epoch 0 [100/469] Loss: 2.3164 Acc: 0.1250 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2934 Acc: 0.1484 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2144 Acc: 0.2422 Iters: 50/50
Epoch 0 [400/469] Loss: 2.2003 Acc: 0.2578 Iters: 50/50
W1228 23:18:18.543000 658569 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1228 23:18:18.543000 658569 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1228 23:18:18.543000 658569 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1228 23:18:18.543000 658569 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1228 23:18:18.543000 658569 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.2527, Train Acc: 0.1824
  Test Loss: 2.0442, Test Acc: 0.2628
  Avg Iters: 50.0/50.0
  Time: 68.6s
Epoch 1 [0/469] Loss: 1.9951 Acc: 0.2656 Iters: 50/50
Epoch 1 [100/469] Loss: 1.9444 Acc: 0.3047 Iters: 50/50
Epoch 1 [200/469] Loss: 1.6669 Acc: 0.3984 Iters: 50/50
Epoch 1 [300/469] Loss: 1.5856 Acc: 0.3906 Iters: 50/50
Epoch 1 [400/469] Loss: 1.2558 Acc: 0.5234 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.6049, Train Acc: 0.4282
  Test Loss: 1.1399, Test Acc: 0.5887
  Avg Iters: 50.0/50.0
  Time: 65.6s
Epoch 2 [0/469] Loss: 1.0911 Acc: 0.7031 Iters: 50/50
Epoch 2 [100/469] Loss: 0.9949 Acc: 0.6250 Iters: 50/50
Epoch 2 [200/469] Loss: 0.9429 Acc: 0.7109 Iters: 50/50
Epoch 2 [300/469] Loss: 0.7207 Acc: 0.7656 Iters: 50/50
Epoch 2 [400/469] Loss: 0.5842 Acc: 0.8359 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.8647, Train Acc: 0.7118
  Test Loss: 0.6430, Test Acc: 0.7986
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 3 [0/469] Loss: 0.6653 Acc: 0.8438 Iters: 50/50
Epoch 3 [100/469] Loss: 0.5983 Acc: 0.8125 Iters: 50/50
Epoch 3 [200/469] Loss: 0.4579 Acc: 0.8281 Iters: 50/50
Epoch 3 [300/469] Loss: 0.4645 Acc: 0.8828 Iters: 50/50
Epoch 3 [400/469] Loss: 0.4762 Acc: 0.8828 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.5686, Train Acc: 0.8295
  Test Loss: 0.4887, Test Acc: 0.8565
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 4 [0/469] Loss: 0.7903 Acc: 0.7969 Iters: 50/50
Epoch 4 [100/469] Loss: 0.3665 Acc: 0.8516 Iters: 50/50
Epoch 4 [200/469] Loss: 0.4431 Acc: 0.8594 Iters: 50/50
Epoch 4 [300/469] Loss: 0.5392 Acc: 0.8438 Iters: 50/50
Epoch 4 [400/469] Loss: 0.6249 Acc: 0.7969 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4634, Train Acc: 0.8652
  Test Loss: 0.3991, Test Acc: 0.8848
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 5 [0/469] Loss: 0.2757 Acc: 0.9297 Iters: 50/50
Epoch 5 [100/469] Loss: 0.4728 Acc: 0.8594 Iters: 50/50
Epoch 5 [200/469] Loss: 0.5194 Acc: 0.8594 Iters: 50/50
Epoch 5 [300/469] Loss: 0.3839 Acc: 0.8750 Iters: 50/50
Epoch 5 [400/469] Loss: 0.4127 Acc: 0.8984 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.4205, Train Acc: 0.8800
  Test Loss: 0.3698, Test Acc: 0.8915
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 6 [0/469] Loss: 0.2480 Acc: 0.9375 Iters: 50/50
Epoch 6 [100/469] Loss: 0.3504 Acc: 0.9453 Iters: 50/50
Epoch 6 [200/469] Loss: 0.5722 Acc: 0.8984 Iters: 50/50
Epoch 6 [300/469] Loss: 0.4205 Acc: 0.8594 Iters: 50/50
Epoch 6 [400/469] Loss: 0.5633 Acc: 0.8203 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3634, Train Acc: 0.8955
  Test Loss: 0.3253, Test Acc: 0.9058
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 7 [0/469] Loss: 0.2515 Acc: 0.9141 Iters: 50/50
Epoch 7 [100/469] Loss: 0.3522 Acc: 0.8594 Iters: 50/50
Epoch 7 [200/469] Loss: 0.3928 Acc: 0.8984 Iters: 50/50
Epoch 7 [300/469] Loss: 0.1967 Acc: 0.9375 Iters: 50/50
Epoch 7 [400/469] Loss: 0.3060 Acc: 0.9062 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3319, Train Acc: 0.9047
  Test Loss: 0.3293, Test Acc: 0.9015
  Avg Iters: 50.0/50.0
  Time: 63.8s
Epoch 8 [0/469] Loss: 0.2362 Acc: 0.9141 Iters: 50/50
Epoch 8 [100/469] Loss: 0.3424 Acc: 0.8750 Iters: 50/50
Epoch 8 [200/469] Loss: 0.3454 Acc: 0.8828 Iters: 50/50
Epoch 8 [300/469] Loss: 0.4592 Acc: 0.8828 Iters: 50/50
Epoch 8 [400/469] Loss: 0.2282 Acc: 0.9141 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3230, Train Acc: 0.9076
  Test Loss: 0.3163, Test Acc: 0.9069
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 9 [0/469] Loss: 0.2702 Acc: 0.9453 Iters: 50/50
Epoch 9 [100/469] Loss: 0.2001 Acc: 0.9375 Iters: 50/50
Epoch 9 [200/469] Loss: 0.4646 Acc: 0.8750 Iters: 50/50
Epoch 9 [300/469] Loss: 0.3865 Acc: 0.8984 Iters: 50/50
Epoch 9 [400/469] Loss: 0.2496 Acc: 0.8906 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3170, Train Acc: 0.9087
  Test Loss: 0.3198, Test Acc: 0.9103
  Avg Iters: 50.0/50.0
  Time: 64.8s
Epoch 10 [0/469] Loss: 0.2153 Acc: 0.9531 Iters: 50/50
Epoch 10 [100/469] Loss: 0.4228 Acc: 0.9141 Iters: 50/50
Epoch 10 [200/469] Loss: 0.3951 Acc: 0.8750 Iters: 50/50
Epoch 10 [300/469] Loss: 0.3088 Acc: 0.9375 Iters: 50/50
Epoch 10 [400/469] Loss: 0.3866 Acc: 0.8828 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.3123, Train Acc: 0.9097
  Test Loss: 0.2911, Test Acc: 0.9152
  Avg Iters: 50.0/50.0
  Time: 63.5s
Epoch 11 [0/469] Loss: 0.2418 Acc: 0.9453 Iters: 50/50
Epoch 11 [100/469] Loss: 0.5027 Acc: 0.8516 Iters: 50/50
Epoch 11 [200/469] Loss: 0.2769 Acc: 0.8984 Iters: 50/50
Epoch 11 [300/469] Loss: 0.4077 Acc: 0.8750 Iters: 50/50
Epoch 11 [400/469] Loss: 0.1432 Acc: 0.9219 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.3264, Train Acc: 0.9071
  Test Loss: 0.7195, Test Acc: 0.7498
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 12 [0/469] Loss: 0.7471 Acc: 0.7422 Iters: 50/50
Epoch 12 [100/469] Loss: 0.4115 Acc: 0.8516 Iters: 50/50
Epoch 12 [200/469] Loss: 0.2077 Acc: 0.9375 Iters: 50/50
Epoch 12 [300/469] Loss: 0.3122 Acc: 0.9141 Iters: 50/50
Epoch 12 [400/469] Loss: 0.1978 Acc: 0.9375 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.3917, Train Acc: 0.8911
  Test Loss: 0.3434, Test Acc: 0.9041
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 13 [0/469] Loss: 0.3102 Acc: 0.9141 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2945 Acc: 0.9219 Iters: 50/50
Epoch 13 [200/469] Loss: 0.2903 Acc: 0.9141 Iters: 50/50
Epoch 13 [300/469] Loss: 0.2103 Acc: 0.9219 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2914 Acc: 0.8984 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.3038, Train Acc: 0.9145
  Test Loss: 0.3059, Test Acc: 0.9119
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 14 [0/469] Loss: 0.3816 Acc: 0.8906 Iters: 50/50
Epoch 14 [100/469] Loss: 0.1790 Acc: 0.9453 Iters: 50/50
Epoch 14 [200/469] Loss: 0.4188 Acc: 0.9219 Iters: 50/50
Epoch 14 [300/469] Loss: 0.3360 Acc: 0.8828 Iters: 50/50
Epoch 14 [400/469] Loss: 0.4189 Acc: 0.8672 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.3037, Train Acc: 0.9151
  Test Loss: 0.2909, Test Acc: 0.9152
  Avg Iters: 50.0/50.0
  Time: 63.6s

======================================================================
Training complete! Best test accuracy: 0.9152
======================================================================
