======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.24, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 2.9682 Acc: 0.1328 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2571 Acc: 0.2422 Iters: 50/50
Epoch 0 [200/469] Loss: 2.2272 Acc: 0.1875 Iters: 50/50
Epoch 0 [300/469] Loss: 2.0953 Acc: 0.2969 Iters: 50/50
Epoch 0 [400/469] Loss: 1.8675 Acc: 0.4141 Iters: 50/50
W1229 00:25:09.224000 662255 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1229 00:25:09.224000 662255 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1229 00:25:09.224000 662255 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1229 00:25:09.224000 662255 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1229 00:25:09.224000 662255 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.1254, Train Acc: 0.2561
  Test Loss: 1.6176, Test Acc: 0.4448
  Avg Iters: 50.0/50.0
  Time: 66.3s
Epoch 1 [0/469] Loss: 1.6549 Acc: 0.4609 Iters: 50/50
Epoch 1 [100/469] Loss: 1.1876 Acc: 0.5469 Iters: 50/50
Epoch 1 [200/469] Loss: 1.1098 Acc: 0.6250 Iters: 50/50
Epoch 1 [300/469] Loss: 0.8902 Acc: 0.7031 Iters: 50/50
Epoch 1 [400/469] Loss: 0.8376 Acc: 0.7812 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.1069, Train Acc: 0.6203
  Test Loss: 0.7561, Test Acc: 0.7695
  Avg Iters: 50.0/50.0
  Time: 65.0s
Epoch 2 [0/469] Loss: 0.7974 Acc: 0.7812 Iters: 50/50
Epoch 2 [100/469] Loss: 0.6800 Acc: 0.7500 Iters: 50/50
Epoch 2 [200/469] Loss: 0.5731 Acc: 0.8203 Iters: 50/50
Epoch 2 [300/469] Loss: 0.7013 Acc: 0.7734 Iters: 50/50
Epoch 2 [400/469] Loss: 0.6528 Acc: 0.8047 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.6365, Train Acc: 0.8053
  Test Loss: 0.5377, Test Acc: 0.8385
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 3 [0/469] Loss: 0.4093 Acc: 0.8828 Iters: 50/50
Epoch 3 [100/469] Loss: 0.6064 Acc: 0.8828 Iters: 50/50
Epoch 3 [200/469] Loss: 0.2805 Acc: 0.9141 Iters: 50/50
Epoch 3 [300/469] Loss: 0.3942 Acc: 0.8906 Iters: 50/50
Epoch 3 [400/469] Loss: 0.5827 Acc: 0.8438 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.4757, Train Acc: 0.8621
  Test Loss: 0.4408, Test Acc: 0.8680
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 4 [0/469] Loss: 0.4225 Acc: 0.8750 Iters: 50/50
Epoch 4 [100/469] Loss: 0.5033 Acc: 0.8594 Iters: 50/50
Epoch 4 [200/469] Loss: 0.3161 Acc: 0.8828 Iters: 50/50
Epoch 4 [300/469] Loss: 0.5456 Acc: 0.8906 Iters: 50/50
Epoch 4 [400/469] Loss: 0.3004 Acc: 0.9062 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4125, Train Acc: 0.8831
  Test Loss: 0.3742, Test Acc: 0.8946
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 5 [0/469] Loss: 0.3663 Acc: 0.9062 Iters: 50/50
Epoch 5 [100/469] Loss: 0.6115 Acc: 0.8594 Iters: 50/50
Epoch 5 [200/469] Loss: 0.3975 Acc: 0.8750 Iters: 50/50
Epoch 5 [300/469] Loss: 0.2238 Acc: 0.9219 Iters: 50/50
Epoch 5 [400/469] Loss: 0.4492 Acc: 0.8594 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.3743, Train Acc: 0.8953
  Test Loss: 0.3485, Test Acc: 0.9042
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 6 [0/469] Loss: 0.3422 Acc: 0.9141 Iters: 50/50
Epoch 6 [100/469] Loss: 0.3872 Acc: 0.9297 Iters: 50/50
Epoch 6 [200/469] Loss: 0.2582 Acc: 0.9219 Iters: 50/50
Epoch 6 [300/469] Loss: 0.3556 Acc: 0.8906 Iters: 50/50
Epoch 6 [400/469] Loss: 0.2259 Acc: 0.9297 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3538, Train Acc: 0.8995
  Test Loss: 0.3201, Test Acc: 0.9086
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 7 [0/469] Loss: 0.2396 Acc: 0.9219 Iters: 50/50
Epoch 7 [100/469] Loss: 0.1397 Acc: 0.9531 Iters: 50/50
Epoch 7 [200/469] Loss: 0.2734 Acc: 0.9297 Iters: 50/50
Epoch 7 [300/469] Loss: 0.3026 Acc: 0.9141 Iters: 50/50
Epoch 7 [400/469] Loss: 0.3302 Acc: 0.9062 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3240, Train Acc: 0.9079
  Test Loss: 0.3290, Test Acc: 0.9015
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 8 [0/469] Loss: 0.2475 Acc: 0.9219 Iters: 50/50
Epoch 8 [100/469] Loss: 0.5442 Acc: 0.8984 Iters: 50/50
Epoch 8 [200/469] Loss: 0.3513 Acc: 0.8906 Iters: 50/50
Epoch 8 [300/469] Loss: 0.3649 Acc: 0.8984 Iters: 50/50
Epoch 8 [400/469] Loss: 0.1688 Acc: 0.9453 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3071, Train Acc: 0.9119
  Test Loss: 0.3053, Test Acc: 0.9113
  Avg Iters: 50.0/50.0
  Time: 64.9s
Epoch 9 [0/469] Loss: 0.2345 Acc: 0.9141 Iters: 50/50
Epoch 9 [100/469] Loss: 0.2603 Acc: 0.9453 Iters: 50/50
Epoch 9 [200/469] Loss: 0.3139 Acc: 0.8750 Iters: 50/50
Epoch 9 [300/469] Loss: 0.3010 Acc: 0.9141 Iters: 50/50
Epoch 9 [400/469] Loss: 0.2027 Acc: 0.9609 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3059, Train Acc: 0.9123
  Test Loss: 0.2768, Test Acc: 0.9204
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 10 [0/469] Loss: 0.3087 Acc: 0.8984 Iters: 50/50
Epoch 10 [100/469] Loss: 0.2667 Acc: 0.9297 Iters: 50/50
Epoch 10 [200/469] Loss: 0.3228 Acc: 0.9062 Iters: 50/50
Epoch 10 [300/469] Loss: 0.2970 Acc: 0.9062 Iters: 50/50
Epoch 10 [400/469] Loss: 0.4260 Acc: 0.8750 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.2889, Train Acc: 0.9164
  Test Loss: 0.2878, Test Acc: 0.9149
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 11 [0/469] Loss: 0.3310 Acc: 0.9453 Iters: 50/50
Epoch 11 [100/469] Loss: 0.2500 Acc: 0.8828 Iters: 50/50
Epoch 11 [200/469] Loss: 0.3971 Acc: 0.9062 Iters: 50/50
Epoch 11 [300/469] Loss: 0.5550 Acc: 0.8438 Iters: 50/50
Epoch 11 [400/469] Loss: 0.4978 Acc: 0.8672 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.4933, Train Acc: 0.8655
  Test Loss: 0.4245, Test Acc: 0.8787
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 12 [0/469] Loss: 0.2764 Acc: 0.9219 Iters: 50/50
Epoch 12 [100/469] Loss: 0.3459 Acc: 0.9062 Iters: 50/50
Epoch 12 [200/469] Loss: 0.2813 Acc: 0.9219 Iters: 50/50
Epoch 12 [300/469] Loss: 0.4432 Acc: 0.8750 Iters: 50/50
Epoch 12 [400/469] Loss: 0.5333 Acc: 0.8438 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.3692, Train Acc: 0.8984
  Test Loss: 0.3438, Test Acc: 0.9073
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 13 [0/469] Loss: 0.3112 Acc: 0.9141 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2011 Acc: 0.9141 Iters: 50/50
Epoch 13 [200/469] Loss: 0.4303 Acc: 0.8828 Iters: 50/50
Epoch 13 [300/469] Loss: 0.3688 Acc: 0.9453 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2493 Acc: 0.9609 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.3474, Train Acc: 0.9072
  Test Loss: 0.3297, Test Acc: 0.9089
  Avg Iters: 50.0/50.0
  Time: 64.3s
Epoch 14 [0/469] Loss: 0.2917 Acc: 0.9297 Iters: 50/50
Epoch 14 [100/469] Loss: 0.1921 Acc: 0.9375 Iters: 50/50
Epoch 14 [200/469] Loss: 0.3752 Acc: 0.8984 Iters: 50/50
Epoch 14 [300/469] Loss: 0.2451 Acc: 0.9375 Iters: 50/50
Epoch 14 [400/469] Loss: 0.2747 Acc: 0.9297 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.3255, Train Acc: 0.9097
  Test Loss: 0.3099, Test Acc: 0.9150
  Avg Iters: 50.0/50.0
  Time: 64.6s

======================================================================
Training complete! Best test accuracy: 0.9204
======================================================================
