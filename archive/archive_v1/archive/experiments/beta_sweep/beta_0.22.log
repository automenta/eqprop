======================================================================
Training TorEqProp on MNIST
======================================================================
Device: cuda
Model: d_model=256, n_heads=8, d_ff=1024
Attention: linear, Symmetric: False
Beta: 0.22, LR: 0.002, Damping: 0.8
Compile: True, Wandb: False
======================================================================
Compiling model with torch.compile...
Epoch 0 [0/469] Loss: 2.8702 Acc: 0.2109 Iters: 50/50
Epoch 0 [100/469] Loss: 2.2666 Acc: 0.1094 Iters: 50/50
Epoch 0 [200/469] Loss: 2.3087 Acc: 0.1719 Iters: 50/50
Epoch 0 [300/469] Loss: 2.2526 Acc: 0.2812 Iters: 50/50
Epoch 0 [400/469] Loss: 2.2401 Acc: 0.2422 Iters: 50/50
W1228 23:51:49.999000 660646 torch/_dynamo/convert_frame.py:964] [0/8] torch._dynamo hit config.recompile_limit (8)
W1228 23:51:49.999000 660646 torch/_dynamo/convert_frame.py:964] [0/8]    function: 'inner' (/home/me/.local/lib/python3.13/site-packages/torch/_dynamo/external_utils.py:68)
W1228 23:51:49.999000 660646 torch/_dynamo/convert_frame.py:964] [0/8]    last reason: 0/7: tensor 'fn._parameters['bias']' size mismatch at index 0. expected 10, actual 256. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W1228 23:51:49.999000 660646 torch/_dynamo/convert_frame.py:964] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W1228 23:51:49.999000 660646 torch/_dynamo/convert_frame.py:964] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.

Epoch 0 Summary:
  Train Loss: 2.2808, Train Acc: 0.1682
  Test Loss: 2.2004, Test Acc: 0.2997
  Avg Iters: 50.0/50.0
  Time: 66.2s
Epoch 1 [0/469] Loss: 2.2272 Acc: 0.2422 Iters: 50/50
Epoch 1 [100/469] Loss: 2.0110 Acc: 0.3438 Iters: 50/50
Epoch 1 [200/469] Loss: 1.5789 Acc: 0.4141 Iters: 50/50
Epoch 1 [300/469] Loss: 1.3979 Acc: 0.4688 Iters: 50/50
Epoch 1 [400/469] Loss: 1.2659 Acc: 0.5938 Iters: 50/50

Epoch 1 Summary:
  Train Loss: 1.5349, Train Acc: 0.4766
  Test Loss: 0.9802, Test Acc: 0.6699
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 2 [0/469] Loss: 0.9579 Acc: 0.6406 Iters: 50/50
Epoch 2 [100/469] Loss: 0.7538 Acc: 0.7969 Iters: 50/50
Epoch 2 [200/469] Loss: 0.7541 Acc: 0.7422 Iters: 50/50
Epoch 2 [300/469] Loss: 0.6076 Acc: 0.7734 Iters: 50/50
Epoch 2 [400/469] Loss: 0.6947 Acc: 0.7969 Iters: 50/50

Epoch 2 Summary:
  Train Loss: 0.7678, Train Acc: 0.7541
  Test Loss: 0.6318, Test Acc: 0.8126
  Avg Iters: 50.0/50.0
  Time: 64.6s
Epoch 3 [0/469] Loss: 0.5337 Acc: 0.8516 Iters: 50/50
Epoch 3 [100/469] Loss: 0.5804 Acc: 0.7969 Iters: 50/50
Epoch 3 [200/469] Loss: 0.5584 Acc: 0.8203 Iters: 50/50
Epoch 3 [300/469] Loss: 0.4665 Acc: 0.8828 Iters: 50/50
Epoch 3 [400/469] Loss: 0.4661 Acc: 0.8438 Iters: 50/50

Epoch 3 Summary:
  Train Loss: 0.5635, Train Acc: 0.8327
  Test Loss: 0.4947, Test Acc: 0.8487
  Avg Iters: 50.0/50.0
  Time: 63.6s
Epoch 4 [0/469] Loss: 0.6846 Acc: 0.7734 Iters: 50/50
Epoch 4 [100/469] Loss: 0.5378 Acc: 0.8516 Iters: 50/50
Epoch 4 [200/469] Loss: 0.3652 Acc: 0.8828 Iters: 50/50
Epoch 4 [300/469] Loss: 0.4546 Acc: 0.8906 Iters: 50/50
Epoch 4 [400/469] Loss: 0.3991 Acc: 0.8906 Iters: 50/50

Epoch 4 Summary:
  Train Loss: 0.4716, Train Acc: 0.8634
  Test Loss: 0.4161, Test Acc: 0.8792
  Avg Iters: 50.0/50.0
  Time: 64.0s
Epoch 5 [0/469] Loss: 0.3412 Acc: 0.9141 Iters: 50/50
Epoch 5 [100/469] Loss: 0.4891 Acc: 0.8672 Iters: 50/50
Epoch 5 [200/469] Loss: 0.3362 Acc: 0.8906 Iters: 50/50
Epoch 5 [300/469] Loss: 0.4457 Acc: 0.8750 Iters: 50/50
Epoch 5 [400/469] Loss: 0.3071 Acc: 0.9297 Iters: 50/50

Epoch 5 Summary:
  Train Loss: 0.4052, Train Acc: 0.8842
  Test Loss: 0.3608, Test Acc: 0.8954
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 6 [0/469] Loss: 0.2411 Acc: 0.9297 Iters: 50/50
Epoch 6 [100/469] Loss: 0.2147 Acc: 0.9375 Iters: 50/50
Epoch 6 [200/469] Loss: 0.3987 Acc: 0.8750 Iters: 50/50
Epoch 6 [300/469] Loss: 0.3701 Acc: 0.9219 Iters: 50/50
Epoch 6 [400/469] Loss: 0.4044 Acc: 0.8594 Iters: 50/50

Epoch 6 Summary:
  Train Loss: 0.3610, Train Acc: 0.8964
  Test Loss: 0.3531, Test Acc: 0.8995
  Avg Iters: 50.0/50.0
  Time: 64.1s
Epoch 7 [0/469] Loss: 0.3632 Acc: 0.9062 Iters: 50/50
Epoch 7 [100/469] Loss: 0.2605 Acc: 0.9219 Iters: 50/50
Epoch 7 [200/469] Loss: 0.3057 Acc: 0.9062 Iters: 50/50
Epoch 7 [300/469] Loss: 0.3645 Acc: 0.8984 Iters: 50/50
Epoch 7 [400/469] Loss: 0.3099 Acc: 0.8984 Iters: 50/50

Epoch 7 Summary:
  Train Loss: 0.3291, Train Acc: 0.9053
  Test Loss: 0.3264, Test Acc: 0.9071
  Avg Iters: 50.0/50.0
  Time: 64.4s
Epoch 8 [0/469] Loss: 0.3779 Acc: 0.8828 Iters: 50/50
Epoch 8 [100/469] Loss: 0.4014 Acc: 0.8984 Iters: 50/50
Epoch 8 [200/469] Loss: 0.2109 Acc: 0.9219 Iters: 50/50
Epoch 8 [300/469] Loss: 0.3159 Acc: 0.9219 Iters: 50/50
Epoch 8 [400/469] Loss: 0.3950 Acc: 0.8906 Iters: 50/50

Epoch 8 Summary:
  Train Loss: 0.3230, Train Acc: 0.9073
  Test Loss: 0.3039, Test Acc: 0.9123
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 9 [0/469] Loss: 0.3840 Acc: 0.8906 Iters: 50/50
Epoch 9 [100/469] Loss: 0.2828 Acc: 0.9141 Iters: 50/50
Epoch 9 [200/469] Loss: 0.5657 Acc: 0.8594 Iters: 50/50
Epoch 9 [300/469] Loss: 0.2901 Acc: 0.9219 Iters: 50/50
Epoch 9 [400/469] Loss: 0.1214 Acc: 0.9531 Iters: 50/50

Epoch 9 Summary:
  Train Loss: 0.3046, Train Acc: 0.9133
  Test Loss: 0.2998, Test Acc: 0.9143
  Avg Iters: 50.0/50.0
  Time: 65.0s
Epoch 10 [0/469] Loss: 0.2129 Acc: 0.9375 Iters: 50/50
Epoch 10 [100/469] Loss: 0.2010 Acc: 0.9297 Iters: 50/50
Epoch 10 [200/469] Loss: 0.2461 Acc: 0.9297 Iters: 50/50
Epoch 10 [300/469] Loss: 0.3367 Acc: 0.9219 Iters: 50/50
Epoch 10 [400/469] Loss: 0.3907 Acc: 0.8828 Iters: 50/50

Epoch 10 Summary:
  Train Loss: 0.2919, Train Acc: 0.9159
  Test Loss: 0.2948, Test Acc: 0.9150
  Avg Iters: 50.0/50.0
  Time: 63.9s
Epoch 11 [0/469] Loss: 0.4220 Acc: 0.9141 Iters: 50/50
Epoch 11 [100/469] Loss: 0.1897 Acc: 0.9375 Iters: 50/50
Epoch 11 [200/469] Loss: 0.1869 Acc: 0.9453 Iters: 50/50
Epoch 11 [300/469] Loss: 0.3331 Acc: 0.9062 Iters: 50/50
Epoch 11 [400/469] Loss: 0.2098 Acc: 0.9141 Iters: 50/50

Epoch 11 Summary:
  Train Loss: 0.2867, Train Acc: 0.9175
  Test Loss: 0.2746, Test Acc: 0.9205
  Avg Iters: 50.0/50.0
  Time: 64.2s
Epoch 12 [0/469] Loss: 0.2345 Acc: 0.9141 Iters: 50/50
Epoch 12 [100/469] Loss: 0.3112 Acc: 0.9062 Iters: 50/50
Epoch 12 [200/469] Loss: 0.3118 Acc: 0.9062 Iters: 50/50
Epoch 12 [300/469] Loss: 0.2320 Acc: 0.9297 Iters: 50/50
Epoch 12 [400/469] Loss: 0.1762 Acc: 0.9375 Iters: 50/50

Epoch 12 Summary:
  Train Loss: 0.2900, Train Acc: 0.9168
  Test Loss: 0.2801, Test Acc: 0.9188
  Avg Iters: 50.0/50.0
  Time: 64.8s
Epoch 13 [0/469] Loss: 0.2766 Acc: 0.9375 Iters: 50/50
Epoch 13 [100/469] Loss: 0.2828 Acc: 0.9219 Iters: 50/50
Epoch 13 [200/469] Loss: 0.2765 Acc: 0.9141 Iters: 50/50
Epoch 13 [300/469] Loss: 0.2741 Acc: 0.9297 Iters: 50/50
Epoch 13 [400/469] Loss: 0.2317 Acc: 0.9219 Iters: 50/50

Epoch 13 Summary:
  Train Loss: 0.2758, Train Acc: 0.9204
  Test Loss: 0.2893, Test Acc: 0.9177
  Avg Iters: 50.0/50.0
  Time: 64.5s
Epoch 14 [0/469] Loss: 0.2127 Acc: 0.9375 Iters: 50/50
Epoch 14 [100/469] Loss: 0.2607 Acc: 0.9219 Iters: 50/50
Epoch 14 [200/469] Loss: 0.4013 Acc: 0.8672 Iters: 50/50
Epoch 14 [300/469] Loss: 0.3128 Acc: 0.9141 Iters: 50/50
Epoch 14 [400/469] Loss: 0.5046 Acc: 0.8984 Iters: 50/50

Epoch 14 Summary:
  Train Loss: 0.2754, Train Acc: 0.9197
  Test Loss: 0.2726, Test Acc: 0.9237
  Avg Iters: 50.0/50.0
  Time: 64.0s

======================================================================
Training complete! Best test accuracy: 0.9237
======================================================================
